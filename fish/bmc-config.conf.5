.TH bmc-config.conf 5 "November 2004" "bmc-config @VERSION@" "User Commands"
.SH "NAME"
bmc-config \- BMC configuration file format and details
.br
.SH "DESCRIPTION"
Before many IPMI tools can be used over a network, a machine's
Baseboard Management Controller (BMC) must be configured.  The
configuration of a BMC can be quite daunting for those who do not know
much about IPMI.  This manpage hopes to provide enough information on
BMC configuration so that you can configure the BMC for your system.
When appropriate, typical BMC configurations will be suggested.

The following is an example BMC configuration file partially generated
from the
.B bmc-config(1)
command.  This example configuration should be sufficient for most
users after the appropriate local IP and MAC addresses are input.
Following this example, separate sections of this manpage will discuss
the different sections of the BMC configuration file in more detail
with explanations of how the BMC can be configured for different
environments.

The below configuration file and most of this manpage assume the user
is interested in configuring a BMC for use with IPMI over LAN.
Various configuration options from 
.B bmc-config(1)
have been left out or skipped because it is considered unnecessary.
Future versions of this manpage will try to include more information.

     Section User1
     	## Give username
     	Username                                     Anonymous
     	## Possible values: Yes/No or blank to not set
     	Enable_User                                  Yes
     	## Give password or leave it blank to clear password
     	Password                                     
     	## Possible values: Yes/No
     	Lan_Enable_Ipmi_Msgs                         Yes
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Lan_Privilege_Limit                          Administrator
     EndSection
     Section User2
     	## Give username
     	Username                                     user2
     	## Possible values: Yes/No or blank to not set
     	Enable_User                                  No
     	## Give password or leave it blank to clear password
     	Password                                     userpass
     	## Possible values: Yes/No
     	Lan_Enable_Ipmi_Msgs                         No
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Lan_Privilege_Limit                          No_Access
     EndSection
     Section User3
     	## Give username
     	Username                                     user3
     	## Possible values: Yes/No or blank to not set
     	Enable_User                                  No
     	## Give password or leave it blank to clear password
     	Password                                     userpass
     	## Possible values: Yes/No
     	Lan_Enable_Ipmi_Msgs                         No
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Lan_Privilege_Limit                          No_Access
     EndSection
     Section User4
     	## Give username
     	Username                                     user4
     	## Possible values: Yes/No or blank to not set
     	Enable_User                                  No
     	## Give password or leave it blank to clear password
     	Password                                     userpass
     	## Possible values: Yes/No
     	Lan_Enable_Ipmi_Msgs                         No
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Lan_Privilege_Limit                          No_Access
     EndSection
     Section LAN_Channel
     	## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
     	Volatile_Access_Mode                         Always_Available
     	## Possible values: Yes/No
     	Volatile_Enable_User_Level_Auth              Yes
     	## Possible values: Yes/No
     	Volatile_Enable_Per_Message_Auth             Yes
     	## Possible values: Yes/No
     	Volatile_Enable_Pef_Alerting                 No
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Volatile_Channel_Privilege_Limit             Administrator
     	## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
     	Non_Volatile_Access_Mode                     Always_Available
     	## Possible values: Yes/No
     	Non_Volatile_Enable_User_Level_Auth          Yes
     	## Possible values: Yes/No
     	Non_Volatile_Enable_Per_Message_Auth         Yes
     	## Possible values: Yes/No
     	Non_Volatile_Enable_Pef_Alerting             No
     	## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
     	Non_Volatile_Channel_Privilege_Limit         Administrator
     EndSection
     Section LAN_Conf
     	## Possible values: Unspecified/Static/Use_DHCP/Use_BIOS/Use_Others
     	Ip_Address_Source                            Static
     	## Give valid IP Address
     	Ip_Address                                   192.168.1.100
     	## Give valid MAC Address
     	Mac_Address                                  00:0E:0E:FF:AA:12
     	## Give valid Subnet mask
     	Subnet_Mask                                  255.255.255.0
     	## Give valid IP Address
     	Default_Gateway_Ip_Address                   192.168.1.1
     	## Give valid MAC Address
     	Default_Gateway_Mac_Address                  00:0E:0E:FF:AA:18
     	## Give valid IP Address
     	Backup_Gateway_Ip_Address                    192.168.1.2
     	## Give valid MAC Address
     	Backup_Gateway_Mac_Address                   00:0E:0E:FF:AA:15
     EndSection
     Section LAN_Conf_Auth
     	## Possible values: Yes/No
     	Callback_Enable_Auth_Type_None               No
     	## Possible values: Yes/No
     	Callback_Enable_Auth_Type_Md2                No
     	## Possible values: Yes/No
     	Callback_Enable_Auth_Type_Md5                No
     	## Possible values: Yes/No
     	Callback_Enable_Auth_Type_Straight_Password  No
     	## Possible values: Yes/No
     	Callback_Enable_Auth_Type_Oem_Proprietary    No
     	## Possible values: Yes/No
     	User_Enable_Auth_Type_None                   No
     	## Possible values: Yes/No
     	User_Enable_Auth_Type_Md2                    Yes
     	## Possible values: Yes/No
     	User_Enable_Auth_Type_Md5                    Yes
     	## Possible values: Yes/No
     	User_Enable_Auth_Type_Straight_Password      No
     	## Possible values: Yes/No
     	User_Enable_Auth_Type_Oem_Proprietary        No
     	## Possible values: Yes/No
     	Operator_Enable_Auth_Type_None               No
     	## Possible values: Yes/No
     	Operator_Enable_Auth_Type_Md2                Yes
     	## Possible values: Yes/No
     	Operator_Enable_Auth_Type_Md5                Yes
     	## Possible values: Yes/No
     	Operator_Enable_Auth_Type_Straight_Password  No
     	## Possible values: Yes/No
     	Operator_Enable_Auth_Type_Oem_Proprietary    No
     	## Possible values: Yes/No
     	Admin_Enable_Auth_Type_None                  No
     	## Possible values: Yes/No
     	Admin_Enable_Auth_Type_Md2                   Yes
     	## Possible values: Yes/No
     	Admin_Enable_Auth_Type_Md5                   Yes
     	## Possible values: Yes/No
     	Admin_Enable_Auth_Type_Straight_Password     No
     	## Possible values: Yes/No
     	Admin_Enable_Auth_Type_Oem_Proprietary       No
     	## Possible values: Yes/No
     	Oem_Enable_Auth_Type_None                    No
     	## Possible values: Yes/No
     	Oem_Enable_Auth_Type_Md2                     No
     	## Possible values: Yes/No
     	Oem_Enable_Auth_Type_Md5                     No
     	## Possible values: Yes/No
     	Oem_Enable_Auth_Type_Straight_Password       No
     	## Possible values: Yes/No
     	Oem_Enable_Auth_Type_Oem_Proprietary         No
     EndSection
     Section LAN_Conf_Misc
     	## Possible values: Yes/No
     	Enable_Gratuitous_Arps                       Yes
     	## Possible values: Yes/No
     	Enable_Arp_Response                          No
     	## Give valid number. Intervals are 500 ms.
     	Gratuitous_Arp_Interval                      4
     EndSection
     Section Misc
     	## Possible Values: Off_State_AC_Apply/Restore_State_AC_Apply/On_State_AC_Apply
     	Power_Restore_Policy                         Restore_State_Ac_Apply
     EndSection

.SH "Section User1, User2, User3, and User4"
The first four sections of the BMC configuration file are for username
configuration of the BMC.  With the exception of the Username for
User1, all four sections are identical.  Most BMCs will allow you to
configure multiple usernames, however some may only allow the single
default user to be configured.

The username(s) you wish to configure the BMC with are defined with
\fIUsername\fR.  The first username under Section User1 is typically
the NULL username and cannot be modified.  The password for the user
can be specified with \fIPassword\fR.  It can be left empty to define
a NULL password.  Each user you wish to enable must be enabled through
the \fIEnable_User\fR configuration option.  It is recommended that
all users have non-NULL passwords or be disabled for security reasons.

\fILan_Enable_Ipmi_Msgs\fR is used to enable or disable IPMI over LAN
access for the user.  This should almost always be enabled so that
IPMI over LAN tools like
.B ipmipower(8)
will work.

\fILan_Privilege_Limit\fR specifies the maximum privilege level limit
the user is allowed.  Different IPMI commands have different privilege
restrictions.  For example, determining the power status of a machine
only requires the 'User' privilege level.  However, power cycling
requires the 'Operator' privilege.  Typically, you will want to assign
atleast one user with the 'Administrator' privilege so that all system
functions are available to atleast one user via IPMI over LAN.

The example configuration above disables all usernames except for the
default 'Anonymous' (or NULL) user.  Many IPMI tools do not (both
open-source and vendor) do not allow the user to input a username and
assume the NULL username by default.  If the tools you are interested
in using allow usernames to be input, then it is recommended that one
of the non-NULL usernames be enabled and the NULL username disabled
for security reasons.

.SH "Section LAN_Channel"

The LAN_Channel section configures a variety of IPMI over LAN
configuration parameters.  Both \fIVolatile\fR and \fINon_Volatile\fR
configurations can be set.  \fIVolatile\fR configurations are
immediately configured onto the BMC and will have immediate effect on
the system.  \fINon_Volatile\fR configurations are only available
after the next system reset.  Generally, both the \fIVolatile\fR and
\fINon_Volatile\fR should be configured identically.

The \fIAccess_Mode\fR parameter configures the availability of IPMI
over LAN on the system.  Typically this should be set to
'Always_Available'.

The \fIPrivilege_Limit\fR sets the maximum privilege any user of the
system can have when performing IPMI over LAN.  This should be set to
the maximum privilege level given to any of the previously defined
system users.  Typically, this should be set to 'Administrator'.

Typically \fIUser_Level_Auth\fR and \fIPer_Message_Auth\fR should be
enabled since disabling them lowers security requirements with
individual IPMI messages.  Disabling \fIUser_Level_Auth\fR allows
'User' privileged IPMI commands to be executed without authentication.
Disabling \fIPer_Message_Auth\fR allows fewer individual IPMI messages
to require authentication.

.SH "Section LAN_Conf"

Those familiar with setting up networks should find most of the fields
in this section self explanatory.  The example BMC configuration above
illustrates the setup of a static IP address.  The field
\fIIP_Address_Source\fR is configured with 'Static'.  The IP address,
subnet mask, and gateway IP addresses of the machine are respecitvely
configured with the \fIIP_Address\fR, \fISubnet_Mask\fR,
\fIDefault_Gateway_Ip_Address\fR, and \fIBackup_Gateway_Ip_Address\fR
fields.  The respective MAC addresses for the IP addresses are
configured under \fIMac_Address\fR, \fIDefault_Gateway_Mac_Address\fR,
and \fIBackup_Gateway_Mac_Address\fR.

To instead setup your BMC network information via DHCP, the field
\fIIP_Address_Source\fR should be configured with 'Use_DHCP'.

It is recommended that static IP addresses be configured for address
resolution reasons.  See the LAN_Conf_Misc section below regarding
gratuitous arps for a more detailed explanation.

.SH "Section LAN_Conf_Auth"

This section determines what types of authentication mechanisms are
allowed for users at different privilege levels.  For example, should
a user with 'Administration' privileges be allowed to authenticate
with a straight password.

Generally speaking, you do not want to allow any user to authenticate
with \fINone\fR or \fIStraight_Password\fR.  \fINone\fR refers to
accepting NULL usernames and NULL passwords.  \fIStraight_Password\fR
means passwords will be sent over a network in cleartext.  \fIMd2\fR
and \fIMd5\fR are digital signature algorithms that can encrypt
passwords.  Typically, these are the only authentication options that
should be enabled.  In the above example, \fIMd2\fR and \fIMd5\fR are
the only authentication mechanisms that are enabled for users with
'User', 'Operator' and 'Administrator' privileges.

.SH "Section LAN_Conf_Misc"

This section lists miscaellaneous IPMI over LAN configuration options.
Normally, these are optional IPMI configuration options that are not
implemented on all BMCs.

Normally, a client cannot resolve the ethernet MAC address without the
remote operating system running, Therefore IPMI over LAN would not
work when a machine is powered off.  One one to work around this is
through gratuitous ARPs.  Gratuitous ARPs are ARP packets generated by
the BMC and sent out to advertise the machine's IP to MAC address
mapping.  Other machines on the network can store this information in
their local ARP cache and allow IPMI over LAN to work when the remote
machine is powered off.  The \fIEnable_Gratuitous_Arps\fR option
allows you to enable or disable this feature.  The
\fIGratuitous_Arp_Interval\fR option allows you to configure the
frequency at which gratuitous ARPs are sent out onto the network.

Instead of gratuitous ARPs some BMCs are able to respond to ARP
requests, even when powered off.  If offerred, this feature can be
enabled through the \fIEnable_Arp_Response\fR option.

Generally speaking, turning on gratuitous ARPs is acceptable.
However, if you are using IPMI on a large cluster, the gratuitous ARPs
may easily flood your network.  They should be tuned to occur less
frequently or disabled.  If disabled, the remote machine's MAC address
can be permanently stored in the local ARP cache.

See
.B bmc-watchdog(8)
for a method which allows gratuitous ARPs to be disabled when the
operating system is running, but enabled when the system is down.

.SH "Section Misc"

The \fIPower_Restore_Policy\fR determines the behavior of the machine
when AC power returns after a power loss.  The behavior can be set to
always power on the machine ('On_State_AC_Apply'), power off the
machine ('Off_State_AC_Apply'), or return the power to the state that
existed before the power loss ('Restore_State_AC_Apply').

.SH "SEE ALSO"
bmc-config(1), ipmipower(8), bmc-watchdog(8)	
