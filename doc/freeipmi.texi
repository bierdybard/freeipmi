\input texinfo @c -*-texinfo-*-
@c This file uses the @command command introduced in Texinfo 4.0.
@c %**start of header
@setfilename freeipmi.info
@settitle The GNU FreeIPMI User's Guide
@finalout
@c %**end of header

@include version-doc.texi

@dircategory Platform Management
@direntry
* GNU FreeIPMI: (freeipmi).  GNU FreeIPMI User's Guide 
@end direntry

@ifinfo
Copyright @copyright{} 2002-2004 FreeIPMI Core Team.

@include permissions.texi
@end ifinfo

@titlepage
@title GNU FreeIPMI User's Guide
@subtitle Free Intelligent Platform Management System
@subtitle Version @value{VERSION} updated on @today{}
@author by Anand Babu @email{ab@@gnu.org.in}

@page
@vskip 0pt plus 1filll
Copyright @copyright{} 2004 FreeIPMI Core Team

@include permissions.texi
@end titlepage

@node Top, Introduction, (dir), (dir)
@ifinfo
User's Guide for @strong{GNU FreeIPMI} platform management system.

This edition of the documentation was last updated on @today{} for
release @value{VERSION} of the GNU FreeIPMI.
@end ifinfo

@c Output the table of contents at the beginning.
@shortcontents
@contents

@c All the menus can be updated with the EMACS command
@c texinfo-all-menus-update, which is normally bound to C-c C-u C-a.
@menu
* Introduction::                Introduction to the GNU FreeIPMI system.
* Installation::                Installing the software.
* libfreeipmi::                 High-level C library for @acronym{IPMI}
* ipmi-locate::                 @acronym{IPMI} device probing tool.
* bmc-config::                  Baseboard Management Controller configurator.
* bmc-info::                    Baseboard Management Controller information.
* bmc-autoconfig::              Wizard-like frontend for bmc-config.
* ipmi-raw::                    executes @acronym{IPMI} commands by hex values.
* ipmi-sensors::                @acronym{IPMI} sensors utility.
* ipmi-sel::                    @acronym{IPMI} System Event Log.
* bmc-watchdog::                Watchdog daemon.
* ipmipower::                   @acronym{IPMI} power control utility.
* ipmiping::                    @acronym{IPMI} ping reachability test utility.
* rmcpping::                    RMCP ping reachability test utility.
* Trouble-shooting::            Trouble-shooting tips.
* Contact us::                  Contact Information.
* Authors::                     FreeIPMI core team members.
* Copying::                     GNU FreeIPMI is a Free Software.
* Glossary::                    Conventions and terminologies. 
* Concept Index::               Index of concepts.
* Program Index::               Index of programs.
@end menu

@node Introduction, Installation, Top, Top
@chapter Introduction to the GNU FreeIPMI system
@cindex Introduction to the GNU FreeIPMI system

GNU FreeIPMI is a Free Intelligent Platform Management System Software.
It provides ``Remote-Console'' (out-of-band), ``System Management
Software'' (in-band) and a development library confirming to
Intelligent  Platform Management Interface (@acronym{IPMI} v1.5 and v2.0) 
standards. 

GNU FreeIPMI User's Guide concentrates installation, usage,
troubleshooting and bug reporting.  It corresponds to @value{VERSION}
release. 

@menu
* Intended Audience::           Who should read this guide?.
* About IPMI::                  Platform Management Standard.
@end menu

@node Intended Audience, About IPMI, Introduction, Introduction
@section Who should read this guide?
If you want to use the @emph{Intelligent Platform Management Interface}
functionalities available on modern motherboards running GNU or any
POSIX compliant operating systems, this guide is right for you.

@c The internals of GNU FreeIPMI system including how to hack,
@c extend or porting to new platforms are documented in a separate manual
@c called @inforef{Top, GNU FreeIPMI Hackers Guide, freeipmi-hg}@.

@node About IPMI,  , Intended Audience, Introduction
@section @acronym{IPMI} - Platform Management Standard

The @acronym{IPMI} specifications define standardized, abstracted interfaces to
the platform management subsystem.  @acronym{IPMI} includes the definition of
interfaces for extending platform management between board within the
main chassis, and between multiple chassis.

The term platform management is used to refer to the monitoring and
control functions that are built in to the platform hardware and
primarily used for the purpose of monitoring the health of the system
hardware.  This typically includes monitoring elements such as system
temperatures, voltages, fans, power supplies, bus errors, system
physical security, etc.  It includes automatic and manually driven
recovery capabilities such as local or remote system resets and power
on/off operations.  It includes the logging of abnormal or out-of-range
conditions for later examination and alerting where the platform
issues the alert without aid of run-time software.  Lastly it includes
inventory information that can help identify a failed hardware unit.

@node Installation, libfreeipmi, Introduction, Top
@chapter Installing GNU FreeIPMI
You can obtain copies of source, binary, documentation and other
useful information from the
@uref{http://www.gnu.org/software/freeipmi, GNU FreeIPMI Home Page}@.

@menu
* Dependencies::                Dependent run-time and libraries.
* Build::                       Compile and install from the source.
* Test Fire::                   Test fire your installation.
@end menu

@node Dependencies, Build, Installation, Installation
@section Dependencies
GNU FreeIPMI is designed to have minimum dependencies on other
libraries and tools.  Only the libfreeipmi library depends on
libgcrypt for encryption use with IPMI 2.0.

List of dependencies under GNU/Linux:
@itemize @bullet
@item GNU libgcrypt
@end itemize

List of dependencies under FreeBSD:
@itemize @bullet
@item FreeBSD (tested on FreeBSD 5.3-BETA7) - @*
You will need "options SYSVSEM" in your kernel config or sysvsem.ko
module loaded. On FreeBSD > 5.2.1 You will also need "device io" in
kernel or loaded as module unless You specify USE_IOPERM compilation
option (see note on i386_set_ioperm below).

@item argp library (tested with argp-standalone-1.3) -
ports/devel/argp-standalone. 
@item gmake
@end itemize

@node Build, Test Fire, Dependencies, Installation
@section Building the source package.

To compile the program, you must first run the @command{configure}
script included with the source tar ball.  It works just like any other
standard GNU @command{autoconf} created script.  See the more generic
configure related installation instructions below.

For complete list of options, try @command{configure --help}@.

Note: Please run @command{./autogen.sh} script before
@command{./configure}, if you are compiling FreeIPMI source from CVS.

Note2: Under some x86-64 platforms such as SUSE GNU/Linux, native 64
bit libraries reside under lib64 and 32 bit libs under lib. Autotools
by default installs libfreeipmi.so under /usr/lib, instead of
/usr/lib64 causing dynamic linking errors.  Pass libdir appropriately
to configure script to workaround this
problem. (i.e. --libdir=/usr/lib64)

@cindex ./configure

@example
 # ./configure --prefix=/usr
 # make
 # make install
@end example

@subsection Installing under FreeBSD:

Example:
@example
  tar xzvf freeipmi-0.3.0.tar.gz
  cd freeipmi-0.3.0
  env CFLAGS="-I/usr/local/include" \
    LDFLAGS="-L/usr/local/lib -largp" \
    ./configure
  gmake all
  # su to root
  gmake install
  mkdir -p /var/lib/freeipmi
  chmod 0700 /var/lib/freeipmi
  touch /var/lib/freeipmi/ipckey
@end example

@subsubsection Using i386_set_ioperm(2) instead of io(4) under FreeBSD:
i386_set_ioperm has known issues on FreeBSD 5.x (bus errors
on io port access), so this patch uses io(4) to access io ports by default.
To enable using i386_set_ioperm instead of io(4) specify USE_IOPERM
copmilation option at configure time:

Example:
@example
    env CFLAGS="-DUSE_IOPERM -I/usr/local/include" \
      LDFLAGS="-L/usr/local/lib -largp" \
      ./configure
@end example

@node Test Fire,  , Build, Installation
@section Test Fire
GNU FreeIPMI works both in-band (with-in the system) and out-of-band
(over the network).  Easiest way to test if your system has @acronym{IPMI}
support or if the installation is OK is through @command{bmc-info}
command.

Test if @acronym{IPMI} works:
@example
ipmitest:~# bmc-info
Device ID:         20
Device Revision:   1
                   [SDR Support]
Firmware Revision: 1.32
                   [Device Available (normal operation)]
IPMI Version:      1.5
Additional Device Support:
                   [Sensor Device]
                   [SDR Repository Device]
                   [SEL Device]
                   [FRU Inventory Device]
                   [IPMB Event Receiver]
                   [Chassis Device]
Manufacturer ID:   B000157h
Product ID:        1Bh
Aux Firmware Revision Info: 10011500h
Channel Information:
       Channel No: 0
      Medium Type: IPMB (I2C)
    Protocol Type: IPMB-1.0
       Channel No: 1
      Medium Type: Asynch. Serial/Modem (RS-232)
    Protocol Type: IPMB-1.0
       Channel No: 3
      Medium Type: PCI SMBus
    Protocol Type: IPMI-SMBus
       Channel No: 4
      Medium Type: System Interface (KCS, SMIC, or BT)
    Protocol Type: KCS
       Channel No: 6
      Medium Type: 802.3 LAN
    Protocol Type: IPMB-1.0
       Channel No: 7
      Medium Type: 802.3 LAN
    Protocol Type: IPMB-1.0
ipmitest:~# 
@end example

If you don't get the expected response from @command{bmc-info} command,
please refer to @ref{Trouble-shooting}@.

@node libfreeipmi, ipmi-locate, Installation, Top
@chapter @acronym{IPMI} C library (libfreeipmi)
@pindex libfreeipmi

The Core of GNU FreeIPMI system consists of LAN, KCS, and SSIF system
interface device drivers, all packaged in a single portable C
library.  Management applications can access the BMC at various levels 
using higher level @acronym{IPMI} command APIs or raw read/write interface to
the driver. 

Library internally uses DMI, SMBIOS, PCI, and ACPI drivers to locate
the system interfaces.

@c If you want to develop your own remote-console or
@c system-management-software or integrate @acronym{IPMI} functionality into your
@c software using C language interface, then you should refer to
@c @ref{Top, GNU FreeIPMI Hackers Guide, freeipmi-hg}@. 

@node ipmi-locate, bmc-config, libfreeipmi, Top
@chapter @acronym{ipmi-locate} IPMI device probing tool
@pindex ipmi-locate
@command{ipmi-locate} tool tries to probe and display
@acronym{KCS}/@acronym{SMIC}/@acronym{BT}/@acronym{SSIF}
@acronym{IPMI} device interface informations by using various probing
techniques.  The tool also displays default values of @acronym{IPMI}
device interfaces of most commonly used in @acronym{BMC}
manufacturers.  This tool may not probe on some machines, but FreeIPMI
tools work on them with default values.  

@section Command-line options

@itemize @bullet
@item --brief @*
      Shorten output.

@item --quiet, --silent @*
      Inhibit usual output.

@item -v, --verbose @*
      Print more information.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.
@end itemize

@section Example
@example
www:~# ipmi-locate 
Probing KCS device using SMBIOS... done
IPMI Version: 1.5
IPMI locate driver: SMBIOS
IPMI locate driver: 0
IPMI interface: KCS
BMC I2C device: (null)
BMC I/O base address: CA2
Register space: 1

Probing SMIC device using SMBIOS... FAILED

Probing BT device using SMBIOS... FAILED

Probing SSIF device using SMBIOS... FAILED

Probing KCS device using ACPI... FAILED

Probing SMIC device using ACPI... FAILED

Probing BT device using ACPI... FAILED

Probing SSIF device using ACPI... FAILED

Probing KCS device using PCI... FAILED

Probing SMIC device using PCI... FAILED

Probing BT device using PCI... FAILED

Probing SSIF device using PCI... FAILED

KCS device default values:
IPMI Version: 1.5
IPMI locate driver: DEFAULT
IPMI locate driver: 0
IPMI interface: KCS
BMC I2C device: (null)
BMC I/O base address: CA2
Register space: 1

SMIC device default values:
IPMI Version: 1.5
IPMI locate driver: DEFAULT
IPMI locate driver: 0
IPMI interface: SMIC
BMC I2C device: (null)
BMC I/O base address: CA9
Register space: 1

BT device default values:

SSIF device default values:
IPMI Version: 1.5
IPMI locate driver: DEFAULT
IPMI locate driver: 0
IPMI interface: SSIF
BMC I2C device: /dev/i2c-0
BMC SMBUS slave address: 20
Register space: 1

www:~# 
@end example

@node bmc-config, bmc-info, ipmi-locate, Top
@chapter bmc-config
@pindex bmc-config
A command line BMC configuration utility.  You can view, set and
replicate the configuration.

@menu
* Options::                     Command-line arguments to bmc-config.
* Sample Configuration File::   Sample Configuration File.
* BMC checkout::                Extracting current BMC configuration.
* BMC commit::                  Update BMC configuration.
* Diff configuration::          Compare BMC configuration.
@end menu

@node Options, Sample Configuration File, bmc-config, bmc-config
@section Command-line arguments to bmc-config

@anchor{bmc-config Command-line options}
@itemize @bullet
@item ---no-probing @*
      Do not probe IPMI devices.

@item -D, ---driver-type=@var{IPMIDRIVER} @*
      Use this @var{IPMIDRIVER} instead of auto selection.  Allowed
      values are KCS, SMIC, SSIF and LAN.

@item ---driver-address=@var{DRIVERADDR} @*
      Use this @var{DRIVERADDR} address instead of probed one.

@item ---driver-device=@var{DEVICE} @*
      Use this @var{DEVICE} for IPMI driver.

@item ---register-spacing=@var{REGISTERSPACING} @*
      Use this @var{REGISTERSPACING} instead of the probed one.

@item -h, ---hostname=@var{IPMIHOST} @*
      Connect to @var{IPMIHOST}.

@item -u, ---username=@var{USERNAME} @*
      Use @var{USERNAME} instead of NULL.  Maximum USERNAME length is
      16.

@item -p, ---password=@var{PASSWORD} @*
      Use @var{PASSWORD} instead of NULL.  Maximum PASSWORD length is
      16.

@item -a, ---auth-type=@var{AUTHTYPE} @*
      Use @var{AUTHTYPE} instead of MD5.  Allowed values are NONE,
      MD2, MD5, and PLAIN.

@item -l, ---priv-level=@var{PRIVILEGE-LEVEL} @*
      Use this @var{PRIVILEGE-LEVEL} instead of ADMIN.  Allowed values
      are CALLBACK, USER, OPERATOR, ADMIN and OEM.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.

@item -o, ---checkout @*
      Fetch configuration information from BMC.

@item -i, ---commit @*
      Update configuration information to BMC.

@item -d, ---diff @*
      Show differences between BMC and config file or key pairs.

@item -f, ---filename=@var{FILENAME} @*
      Use this file for BMC get/set.

@item -k, ---key-pair=@var{KEY-PAIR} @*
      Update configuration information to BMC. This option can be used
      multiple times.

@item -S, ---section=@var{SECTION} @*
      Use SECTION for checkout.  This option can be used multiple times.

@item -L, ---listsections @*
      List available sections for checkout.

@item -v, ---verbose @*
      Print detailed information.

@end itemize

@node Sample Configuration File, BMC checkout, Options, bmc-config
@section Sample Configuration File
@command{bmc-config} emits current BMC configuration settings to
stdout in the same format as that of configuration file, when no file
argument is specified.

@cindex bmc-config configuration file 

Example: Extracting BMC configuration to stdout.
@example
debian-ia64:~# bmc-config --checkout 
Section User1
        ## Give Username
        Username                                     NULL
        ## Possible values: Yes/No or blank to not set
        ## Enable_User
        ## Give password or blank to clear. MAX 16 chars.
        ## Password
        ## Possible values: Yes/No
        Lan_Enable_IPMI_Msgs                         No
        ## Possible values: Yes/No
        Lan_Enable_Link_Auth                         No
        ## Possible values: Yes/No
        Lan_Enable_Restricted_to_Callback            No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Lan_Privilege_Limit                          No_Access
        ## Possible values: Yes/No
        Serial_Enable_IPMI_Msgs                      No
        ## Possible values: Yes/No
        Serial_Enable_Link_Auth                      No
        ## Possible values: Yes/No
        Serial_Enable_Restricted_to_Callback         No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Serial_Privilege_Limit                       Administrator
EndSection
Section User2
        ## Give Username
        Username                                     USER
        ## Possible values: Yes/No or blank to not set
        ## Enable_User
        ## Give password or blank to clear. MAX 16 chars.
        ## Password
        ## Possible values: Yes/No
        Lan_Enable_IPMI_Msgs                         Yes
        ## Possible values: Yes/No
        Lan_Enable_Link_Auth                         No
        ## Possible values: Yes/No
        Lan_Enable_Restricted_to_Callback            No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Lan_Privilege_Limit                          User
        ## Possible values: 0-255, 0 is unlimited
        Serial_Enable_IPMI_Msgs                      No
        ## Possible values: Yes/No
        Serial_Enable_Link_Auth                      No
        ## Possible values: Yes/No
        Serial_Enable_Restricted_to_Callback         No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Serial_Privilege_Limit                       No_Access
EndSection
Section User3
        ## Give Username
        Username                                     OPERATOR
        ## Possible values: Yes/No or blank to not set
        ## Enable_User
        ## Give password or blank to clear. MAX 16 chars.
        ## Password
        ## Possible values: Yes/No
        Lan_Enable_IPMI_Msgs                         Yes
        ## Possible values: Yes/No
        Lan_Enable_Link_Auth                         No
        ## Possible values: Yes/No
        Lan_Enable_Restricted_to_Callback            No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Lan_Privilege_Limit                          Operator
        ## Possible values: Yes/No
        Serial_Enable_IPMI_Msgs                      No
        ## Possible values: Yes/No
        Serial_Enable_Link_Auth                      No
        ## Possible values: Yes/No
        Serial_Enable_Restricted_to_Callback         No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Serial_Privilege_Limit                       No_Access
EndSection
Section User4
        ## Give Username
        Username                                     ADMIN
        ## Possible values: Yes/No or blank to not set
        ## Enable_User
        ## Give password or blank to clear. MAX 16 chars.
        ## Password
        ## Possible values: Yes/No
        Lan_Enable_IPMI_Msgs                         Yes
        ## Possible values: Yes/No
        Lan_Enable_Link_Auth                         No
        ## Possible values: Yes/No
        Lan_Enable_Restricted_to_Callback            No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Lan_Privilege_Limit                          Administrator
        ## Possible values: Yes/No
        Serial_Enable_IPMI_Msgs                      No
        ## Possible values: Yes/No
        Serial_Enable_Link_Auth                      No
        ## Possible values: Yes/No
        Serial_Enable_Restricted_to_Callback         No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Serial_Privilege_Limit                       No_Access
EndSection
Section Lan_Channel
        ## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
        Volatile_Access_Mode                         Always_Available
        ## Possible values: Yes/No
        Volatile_Enable_User_Level_Auth              Yes
        ## Possible values: Yes/No
        Volatile_Enable_Per_Message_Auth             Yes
        ## Possible values: Yes/No
        Volatile_Enable_Pef_Alerting                 No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Volatile_Channel_Privilege_Limit             Administrator
        ## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
        Non_Volatile_Access_Mode                     Always_Available
        ## Possible values: Yes/No
        Non_Volatile_Enable_User_Level_Auth          Yes
        ## Possible values: Yes/No
        Non_Volatile_Enable_Per_Message_Auth         Yes
        ## Possible values: Yes/No
        Non_Volatile_Enable_Pef_Alerting             No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Non_Volatile_Channel_Privilege_Limit         Administrator
EndSection
Section Lan_Conf
        ## Possible values: Unspecified/Static/Use_DHCP/Use_BIOS/Use_Others
        IP_Address_Source                            Static
        ## Give valid IP address
        IP_Address                                   192.168.1.60
        ## Give valid MAC address
        MAC_Address                                  00:0E:0C:21:81:B4
        ## Give valid Subnet Mask
        Subnet_Mask                                  255.255.255.0
        ## Give valid IP address
        Default_Gateway_IP_Address                   0.0.0.0
        ## Give valid MAC address
        Default_Gateway_MAC_Address                  00:00:00:00:00:00
        ## Give valid IP address
        Backup_Gateway_IP_Address                    0.0.0.0
        ## Give valid MAC address
        Backup_Gateway_MAC_Address                   00:00:00:00:00:00
EndSection
Section Lan_Conf_Auth
        ## Possible values: Yes/No
        Callback_Enable_Auth_Type_None               No
        ## Possible values: Yes/No
        Callback_Enable_Auth_Type_MD2                No
        ## Possible values: Yes/No
        Callback_Enable_Auth_Type_MD5                No
        ## Possible values: Yes/No
        Callback_Enable_Auth_Type_Straight_Password  No
        ## Possible values: Yes/No
        Callback_Enable_Auth_Type_OEM_Proprietary    No
        ## Possible values: Yes/No
        User_Enable_Auth_Type_None                   No
        ## Possible values: Yes/No
        User_Enable_Auth_Type_MD2                    No
        ## Possible values: Yes/No
        User_Enable_Auth_Type_MD5                    Yes
        ## Possible values: Yes/No
        User_Enable_Auth_Type_Straight_Password      No
        ## Possible values: Yes/No
        User_Enable_Auth_Type_OEM_Proprietary        No
        ## Possible values: Yes/No
        Operator_Enable_Auth_Type_None               No
        ## Possible values: Yes/No
        Operator_Enable_Auth_Type_MD2                No
        ## Possible values: Yes/No
        Operator_Enable_Auth_Type_MD5                Yes
        ## Possible values: Yes/No
        Operator_Enable_Auth_Type_Straight_Password  No
        ## Possible values: Yes/No
        Operator_Enable_Auth_Type_OEM_Proprietary    No
        ## Possible values: Yes/No
        Admin_Enable_Auth_Type_None                  No
        ## Possible values: Yes/No
        Admin_Enable_Auth_Type_MD2                   No
        ## Possible values: Yes/No
        Admin_Enable_Auth_Type_MD5                   Yes
        ## Possible values: Yes/No
        Admin_Enable_Auth_Type_Straight_Password     No
        ## Possible values: Yes/No
        Admin_Enable_Auth_Type_OEM_Proprietary       No
        ## Possible values: Yes/No
        OEM_Enable_Auth_Type_None                    No
        ## Possible values: Yes/No
        OEM_Enable_Auth_Type_MD2                     No
        ## Possible values: Yes/No
        OEM_Enable_Auth_Type_MD5                     No
        ## Possible values: Yes/No
        OEM_Enable_Auth_Type_Straight_Password       No
        ## Possible values: Yes/No
        OEM_Enable_Auth_Type_OEM_Proprietary         No
EndSection
Section Lan_Conf_Security_Keys
        ## Give string or blank to clear. Max 20 chars
        ## K_R
        ## Give string or blank to clear. Max 20 chars
        ## K_G
EndSection
Section Lan_Conf_Misc
        ## Possible values: Yes/No
        Enable_Gratuitous_ARPs                       No
        ## Possible values: Yes/No
        Enable_ARP_Response                          No
        ## Give a number (x 500ms)
        Gratuitous_ARP_Interval                      10
EndSection
Section Rmcpplus_Conf_Privilege
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_0          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_1          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_2          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_3          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_4          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_5          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_6          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_7          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_8          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_9          Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_10         Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_11         Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_12         Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_13         Administrator
        ## Possible values: Unused/User/Operator/Administrator/OEM_Proprietary
        Maximum_Privilege_Cipher_Suite_Id_14         Administrator
EndSection
Section Serial_Channel
        ## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
        Volatile_Access_Mode                         Always_Available
        ## Possible values: Yes/No
        Volatile_Enable_User_Level_Auth              Yes
        ## Possible values: Yes/No
        Volatile_Enable_Per_Message_Auth             No
        ## Possible values: Yes/No
        Volatile_Enable_Pef_Alerting                 No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Volatile_Channel_Privilege_Limit             Administrator
        ## Possible values: Disabled/Pre_Boot_Only/Always_Available/Shared
        Non_Volatile_Access_Mode                     Always_Available
        ## Possible values: Yes/No
        Non_Volatile_Enable_User_Level_Auth          Yes
        ## Possible values: Yes/No
        Non_Volatile_Enable_Per_Message_Auth         No
        ## Possible values: Yes/No
        Non_Volatile_Enable_Pef_Alerting             No
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary/No_Access
        Non_Volatile_Channel_Privilege_Limit         Administrator
EndSection
Section Serial_Conf
        ## Possible values: Yes/No
        Enable_Basic_Mode                            Yes
        ## Possible values: Yes/No
        Enable_PPP_Mode                              Yes
        ## Possible values: Yes/No
        Enable_Terminal_Mode                         Yes
        ## Possible values: Modem_Connect/Direct_Mode
        Connect_Mode                                 Direct_Connect
        ## Give a valid number
        Page_Blackout_Interval                       0
        ## Give a valid number
        Call_Retry_Interval                          60
        ## Possible values: Yes/No
        Enable_DTR_Hangup                            No
        ## Possible values: No_Flow_Control/RTS_CTS/XON_XOFF
        Flow_Control                                 No_Flow_Control
        ## Possible values: 9600/19200/38400/57600/115200
        Bit_Rate                                     115200
EndSection
Section PEF_Conf
        ## Possible values: Yes/No
        Enable_PEF                                   No
        ## Possible values: Yes/No
        Enable_PEF_Event_Messages                    No
        ## Possible values: Yes/No
        Enable_PEF_Startup_Delay                     No
        ## Possible values: Yes/No
        Enable_PEF_Alert_Startup_Delay               No
        ## Possible values: Yes/No
        Enable_Alert_Action                          Yes
        ## Possible values: Yes/No
        Enable_Power_Down_Action                     Yes
        ## Possible values: Yes/No
        Enable_Reset_Action                          Yes
        ## Possible values: Yes/No
        Enable_Power_Cycle_Action                    Yes
        ## Possible values: Yes/No
        Enable_OEM_Action                            No
        ## Possible values: Yes/No
        Enable_Diagnostic_Interrupt                  Yes
        ## Give value in seconds
        PEF_Startup_Delay                            255
        ## Give value in seconds
        PEF_Alert_Startup_Delay                      60
EndSection
Section SOL_Conf
        ## Possible values: Yes/No
        Enable_SOL                                   Yes
        ## Possible values: Callback/User/Operator/Administrator/OEM_Proprietary
        SOL_Privilege_Level                          Administrator
        ## Possible values: Yes/No
        Force_SOL_Payload_Authentication             Yes
        ## Possible values: Yes/No
        Force_SOL_Payload_Encryption                 Yes
        ## Give a valid integer. Each unit is 5ms
        Character_Accumulate_Interval                50
        ## Give a valid number
        Character_Send_Threshold                     100
        ## Give a valid integer
        SOL_Retry_Count                              5
        ## Give a valid integer. Interval unit is 10ms
        SOL_Retry_Interval                           50
        ## Possible values: Serial/9600/19200/38400/57600/115200
        Non_Volatile_Bit_Rate                        115200
        ## Possible values: Serial/9600/19200/38400/57600/115200
        Volatile_Bit_Rate                            115200
        ## Give a valid port number
        ## SOL_Payload_Port_Number                   623
EndSection
Section Misc
        ## Possible values: Off_State_AC_Apply/Restore_State_AC_Apply/On_State_AC_Apply
        Power_Restore_Policy                         Off_State_AC_Apply
EndSection
debian-ia64:~#
@end example

@node BMC checkout, BMC commit, Sample Configuration File, bmc-config
@section Extracting current BMC configuration
`checkout'' option generates a configuration file containing
the current BMC settings.  Configuration file is in plain text format
with sections enclosing key-value pairs.  Comments will guide you to
choose appropriate values.  Use your favorite editor (like GNU Emacs)
to edit these fields.  Comment character is @samp{#}@.

Example: Creating a BMC configuration file.
@example
debian-ia64:~# bmc-config --checkout --filename=/tmp/bmc.conf
@end example

Alternatively you can redirect stdout to the configuration file too.
@example
debian-ia64:~# bmc-config --checkout > /tmp/bmc.conf
@end example

@node BMC commit, Diff configuration, BMC checkout, bmc-config
@section Update BMC configuration
After customizing the BMC configuration file, you can update the
BMC configuration using ``commit'' option.

Example using configuration file:
@example
debian-ia64:~# bmc-config --commit -f /tmp/bmc.conf
@end example

Example using a specific key:
@example
debian-ia64:~# bmc-config --commit -k "Lan_conf:Ip_Address=192.168.1.60"
@end example

Note: At this point of time, configuration settings can only be fed
through a file or key-value pairs and not stdin.

@node Diff configuration, , BMC commit, bmc-config
@section Compare BMC configuration

To compare the differences between current active BMC settings and the
configuration file, use ``diff'' option

Example: Comparing the configuration file and BMC settings.
@example
debian-ia64:~# bmc-config --diff -f /tmp/bmc.conf
Lan_Conf:IP_Address - input=`192.168.10.160':actual=`192.168.1.60'
debian-ia64:~# bmc-config --diff -k "User2:Username=guest"
User2:Username - input=`guest':actual=`usertest'
debian-ia64:~# 
@end example

@node bmc-info, bmc-autoconfig, bmc-config, Top
@chapter bmc-info
@pindex bmc-info
@command{bmc-info} command displays BMC/@acronym{IPMI} version information and
the list of additional devices supported.  This command is mostly used
for checking if @acronym{IPMI} is supported or if BMC/FRU/SDR firmware upgrade
completed successfully.

@section Command-line options

@itemize @bullet
@item ---no-probing @*
      Do not probe IPMI devices.

@item -D, ---driver-type=@var{IPMIDRIVER} @*
      Use this @var{IPMIDRIVER} instead of auto selection.  Allowed
      values are KCS, SMIC, SSIF and LAN.

@item ---driver-address=@var{DRIVERADDR} @*
      Use this @var{DRIVERADDR} address instead of probed one.

@item ---driver-device=@var{DEVICE} @*
      Use this @var{DEVICE} for IPMI driver.

@item ---register-spacing=@var{REGISTERSPACING} @*
      Use this @var{REGISTERSPACING} instead of the probed one.

@item -h, ---hostname=@var{IPMIHOST} @*
      Connect to @var{IPMIHOST}.

@item -u, ---username=@var{USERNAME} @*
      Use @var{USERNAME} instead of NULL.  Maximum USERNAME length is
      16.

@item -p, ---password=@var{PASSWORD} @*
      Use @var{PASSWORD} instead of NULL.  Maximum PASSWORD length is
      16.

@item -a, ---auth-type=@var{AUTHTYPE} @*
      Use @var{AUTHTYPE} instead of MD5.  Allowed values are NONE,
      MD2, MD5, and PLAIN.

@item -l, ---priv-level=@var{PRIVILEGE-LEVEL} @*
      Use this @var{PRIVILEGE-LEVEL} instead of USER.  Allowed values
      are CALLBACK, USER, OPERATOR, ADMIN and OEM.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.
@end itemize

@section Example
@example
ipmitest:~# bmc-info
Device ID:         20
Device Revision:   1
                   [SDR Support]
Firmware Revision: 1.32
                   [Device Available (normal operation)]
IPMI Version:      1.5
Additional Device Support:
                   [Sensor Device]
                   [SDR Repository Device]
                   [SEL Device]
                   [FRU Inventory Device]
                   [IPMB Event Receiver]
                   [Chassis Device]
Manufacturer ID:   B000157h
Product ID:        1Bh
Aux Firmware Revision Info: 10011500h
Channel Information:
       Channel No: 0
      Medium Type: IPMB (I2C)
    Protocol Type: IPMB-1.0
       Channel No: 1
      Medium Type: Asynch. Serial/Modem (RS-232)
    Protocol Type: IPMB-1.0
       Channel No: 3
      Medium Type: PCI SMBus
    Protocol Type: IPMI-SMBus
       Channel No: 4
      Medium Type: System Interface (KCS, SMIC, or BT)
    Protocol Type: KCS
       Channel No: 6
      Medium Type: 802.3 LAN
    Protocol Type: IPMB-1.0
       Channel No: 7
      Medium Type: 802.3 LAN
    Protocol Type: IPMB-1.0
ipmitest:~# 
@end example

@node bmc-autoconfig, ipmi-raw, bmc-info, Top
@chapter bmc-autoconfig
@pindex bmc-autoconfig
@command{bmc-autoconfig} utility is a wizard-like high-level frontend
to the @command{bmc-config} command, which has a curses/text user
interface prompting for IP/Netmask/Gateway.

@section Command-line options

@command{bmc-autoconfig} command-line options are as same as
@command{bmc-config} utility. If no arguments are passed, wizard interface is
shown. For a complete list of options, refer here
@xref{bmc-config Command-line options}.

@node ipmi-raw, ipmi-sensors, bmc-autoconfig, Top
@chapter ipmi-raw
@pindex ipmi-raw
@command{ipmi-raw} tool reads hex values of @acronym{IPMI} command
request data from standard input, executes it and displays hex values
of @acronym{IPMI} command response data.  This tool works on in-band
and out-of-band.

@section Command-line options

@itemize @bullet
@item ---no-probing @*
      Do not probe IPMI devices.

@item -D, ---driver-type=@var{IPMIDRIVER} @*
      Use this @var{IPMIDRIVER} instead of auto selection.  Allowed
      values are KCS, SMIC, SSIF and LAN.

@item ---driver-address=@var{DRIVERADDR} @*
      Use this @var{DRIVERADDR} address instead of probed one.

@item ---driver-device=@var{DEVICE} @*
      Use this @var{DEVICE} for IPMI driver.

@item ---register-spacing=@var{REGISTERSPACING} @*
      Use this @var{REGISTERSPACING} instead of the probed one.

@item -h, ---hostname=@var{IPMIHOST} @*
      Connect to @var{IPMIHOST}.

@item -u, ---username=@var{USERNAME} @*
      Use @var{USERNAME} instead of NULL.  Maximum USERNAME length is
      16.

@item -p, ---password=@var{PASSWORD} @*
      Use @var{PASSWORD} instead of NULL.  Maximum PASSWORD length is
      16.

@item -a, ---auth-type=@var{AUTHTYPE} @*
      Use @var{AUTHTYPE} instead of NONE.  Allowed values are NONE,
      MD2, MD5, and PLAIN.

@item -l, ---priv-level=@var{PRIVILEGE-LEVEL} @*
      Use this @var{PRIVILEGE-LEVEL} instead of USER.  Allowed values
      are CALLBACK, USER, OPERATOR, ADMIN and OEM.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.
@end itemize

@section Example
@example
www:~# ipmi-raw
0 6 01
rcvd: 1C 01 00 20 81 01 20 51 9F 57 01 00 1B 00 00 15 01 10 
www:~# 
@end example

@node ipmi-sensors, ipmi-sel, ipmi-raw, Top
@chapter ipmi-sensors
@pindex ipmi-sensors
@command{ipmi-sensors} utility reports the monitored system health
information, such as temperatures and voltages, fan status, etc with
nominal, threshold max/min readings and status descriptions.

@menu
* ipmi-sensors options::        Command-line arguments.
* ipmi-sensors example::        Example.
@end menu

@node ipmi-sensors options, ipmi-sensors example, ipmi-sensors, ipmi-sensors
@section command-line arguments
@itemize @bullet
@item ---no-probing @*
      Do not probe IPMI devices.

@item -D, ---driver-type=@var{IPMIDRIVER} @*
      Use this @var{IPMIDRIVER} instead of auto selection.  Allowed
      values are KCS, SMIC, SSIF and LAN.

@item ---driver-address=@var{DRIVERADDR} @*
      Use this @var{DRIVERADDR} address instead of probed one.

@item ---driver-device=@var{DEVICE} @*
      Use this @var{DEVICE} for IPMI driver.

@item ---register-spacing=@var{REGISTERSPACING} @*
      Use this @var{REGISTERSPACING} instead of the probed one.

@item -h, ---hostname=@var{IPMIHOST} @*
      Connect to @var{IPMIHOST}.

@item -u, ---username=@var{USERNAME} @*
      Use @var{USERNAME} instead of NULL.  Maximum USERNAME length is
      16.

@item -p, ---password=@var{PASSWORD} @*
      Use @var{PASSWORD} instead of NULL.  Maximum PASSWORD length is
      16.

@item -a, ---auth-type=@var{AUTHTYPE} @*
      Use @var{AUTHTYPE} instead of MD5.  Allowed values are NONE,
      MD2, MD5, and PLAIN.

@item -l, ---priv-level=@var{PRIVILEGE-LEVEL} @*
      Use this @var{PRIVILEGE-LEVEL} instead of USER.  Allowed values
      are CALLBACK, USER, OPERATOR, ADMIN and OEM.

@item -v, ---verbose @*
      Verbose sensor output.

@item -vv @*
      Very verbose sensor output.

@item -i, ---sdr-info @*
      Show SDR Information.

@item -f, ---flush-cache @*
      Flush sensor cache.

@item -L, ---list-groups @*
      List sensor groups.

@item -g, ---group=@var{GROUP-NAME} @*
      Show sensors belongs to this GROUP.

@item -s, ---sensors=@var{SENSORS-LIST} @* 
      Show listed sensors.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.
@end itemize

@node ipmi-sensors example,  , ipmi-sensors options, ipmi-sensors
@section ipmi-sensors output
@example
www:~# ipmi-sensors 
1: MB Bd +1.25V (Voltage): 1.27 V (1.15/1.34): [OK]
2: MB Bd +1.5V (Voltage): 1.57 V (1.38/1.61): [OK]
3: MB Bd +1.8V (Voltage): 1.80 V (1.66/1.93): [OK]
4: MB Bd +3.3V (Voltage): 3.33 V (3.04/3.53): [OK]
5: MB Bd +3.3V SB (Voltage): 3.40 V (2.93/3.58): [OK]
6: MB Bd +5V (Voltage): 4.91 V (4.60/5.36): [OK]
7: MB Bd +12V (Voltage): 11.97 V (10.97/12.77): [OK]
8: MB Bd -12V (Voltage): -12.13 V (-13.00/-11.20): [OK]
9: MB Bd +1.2V (Voltage): 1.22 V (1.08/1.31): [OK]
10: MB Bd +1.3V (Voltage): 1.31 V (1.17/1.42): [OK]
11: MB Bd +1.5V SB (Voltage): 1.50 V (1.38/1.61): [OK]
12: MB Bd +2.5V (Voltage): 2.49 V (2.28/2.69): [OK]
13: MB Bd +2.5V SB (Voltage): 2.52 V (2.28/2.69): [OK]
14: MB Bd +5V SB (Voltage): 5.10 V (4.50/5.34): [OK]
15: MB Bd Temp (Temperature): 33.00 C (5.00/55.00): [OK]
16: MB Bd SNC Temp (Temperature): 46.00 C (5.00/105.00): [OK]
17: MB Bd SIOH Temp (Temperature): 38.00 C (5.00/95.00): [OK]
18: FPBD AMB Temp (Temperature): 20.00 C (5.00/50.00): [OK]
19: PCI Rsr Temp (Temperature): 23.00 C (5.00/60.00): [OK]
20: CPU AREA Temp (Temperature): 20.00 C (5.00/60.00): [OK]
21: MEM AREA Temp (Temperature): 35.00 C (5.00/80.00): [OK]
22: Bnk1 Tach Fan 6 (Fan): 6174.00 RPM (5040.00/NA): [OK]
23: Bnk1 Tach Fan 5 (Fan): 6636.00 RPM (5040.00/NA): [OK]
24: Bnk1 Tach Fan 4 (Fan): 6594.00 RPM (5040.00/NA): [OK]
25: Bnk2 Tach Fan 3 (Fan): 7009.00 RPM (5676.00/NA): [OK]
26: Bnk2 Tach Fan 2 (Fan): 6579.00 RPM (5676.00/NA): [OK]
27: Bnk2 Tach Fan 1 (Fan): 6762.00 RPM (5544.00/NA): [OK]
28: MB FanBst (OEM Reserved): 33.00 C (NA/NA): [OK]
29: MB SNC FanBst (OEM Reserved): 46.00 C (NA/NA): [OK]
30: MB SIOH FanBst (OEM Reserved): 38.00 C (NA/NA): [OK]
31: FPBD AMB FanBst (OEM Reserved): 20.00 C (NA/NA): [OK]
32: PCI RSR FanBst (OEM Reserved): 23.00 C (NA/NA): [OK]
33: CPU Area FanBst (OEM Reserved): 20.00 C (NA/NA): [OK]
34: MEM Area FanBst (OEM Reserved): 35.00 C (NA/NA): [OK]
35: Proc 1 Temp (Temperature): 39.00 C (2.00/112.00): [OK]
36: Proc 2 Temp (Temperature): 39.00 C (2.00/112.00): [OK]
37: Proc 1 FanBst (OEM Reserved): 39.00 C (NA/NA): [OK]
38: Proc 2 FanBst (OEM Reserved): 39.00 C (NA/NA): [OK]
39: HSC SCSI BP Temp (Temperature): NA(NA/NA): [Unknown]
40: Pwr Unit Status (Power Unit): [OK]
41: Pwr Unit Redund (Power Unit): [Redundancy Lost]
42: Watchdog  (Watchdog 2): [OK]
43: Scrty Violation (Platform Security Violation): [OK]
44: Physical Scrty (Platform Chassis Intrusion): [OK]
45: POST Error (System Firmware): [OK]
46: Crit Int Status (Critical Interrupt): [OK]
47: EVT Log Disabled (Event Logging Disabled): [OK]
48: System Event (System Event): [OK]
49: Int SCSI TERMV0 (Voltage): [Performance Met]
50: Int SCSI TERMV1 (Voltage): [Performance Met]
51: Int SCSI TERMV2 (Voltage): [Performance Met]
52: Ext SCSI TERMV0 (Voltage): [Performance Met]
53: Ext SCSI TERMV1 (Voltage): [Performance Met]
54: Ext SCSI TERMV2 (Voltage): [Performance Met]
55: Pwr Supply 1 (Power Supply): [Presence detected]
56: Pwr Supply 2 (Power Supply): [Presence detected]
57: Pwr Supply 3 (Power Supply): [OK]
58: Fan 6 Present (Fan): [Device Inserted/Device Present]
59: Fan 5 Present (Fan): [Device Inserted/Device Present]
60: Fan 4 Present (Fan): [Device Inserted/Device Present]
61: Fan 3 Present (Fan): [Device Inserted/Device Present]
62: Fan 2 Present (Fan): [Device Inserted/Device Present]
63: Fan 1 Present (Fan): [Device Inserted/Device Present]
64: SYS Bd Intrlock (Board): [Device Inserted/Device Present]
65: INIT State (OEM Reserved): [OK]
66: Proc 1 Status (Processor): [Processor Presence detected]
67: Proc 2 Status (Processor): [Processor Presence detected]
68: Proc 1 PpodGd (Voltage): [Performance Met]
69: Proc 2 PpodGd (Voltage): [Performance Met]
70: HSC Drv 1 Status (Drive Slot): [Unknown]
71: HSC Drv 2 Status (Drive Slot): [Unknown]
72: HSC Drv 1 Pres (Drive Slot): [Unknown]
73: HSC Drv 2 Pres (Drive Slot): [Unknown]
www:~# 
@end example

@node ipmi-sel, bmc-watchdog, ipmi-sensors, Top
@chapter ipmi-sel
@pindex ipmi-sel
BMC provides a centralized, non-volatile System Event Log and logs
system events and certain system configuration information to this
device. You can perform a postmortem analysis on a system even when a
the processor(s) are disabled because of a failure.  ipmi-sel utility helps
you view and manage system event log.

@menu
* ipmi-sel options::            Command-line arguments.
* ipmi-sel sample output::      
@end menu

@node ipmi-sel options, ipmi-sel sample output, ipmi-sel, ipmi-sel
@section command-line arguments

@itemize @bullet
@item ---no-probing @*
      Do not probe IPMI devices.

@item -D, ---driver-type=@var{IPMIDRIVER} @*
      Use this @var{IPMIDRIVER} instead of auto selection.  Allowed
      values are KCS, SMIC, SSIF and LAN.

@item ---driver-address=@var{DRIVERADDR} @*
      Use this @var{DRIVERADDR} address instead of probed one.

@item ---driver-device=@var{DEVICE} @*
      Use this @var{DEVICE} for IPMI driver.

@item ---register-spacing=@var{REGISTERSPACING} @*
      Use this @var{REGISTERSPACING} instead of the probed one.

@item -h, ---hostname=@var{IPMIHOST} @*
      Connect to @var{IPMIHOST}.

@item -u, ---username=@var{USERNAME} @*
      Use @var{USERNAME} instead of NULL.  Maximum USERNAME length is
      16.

@item -p, ---password=@var{PASSWORD} @*
      Use @var{PASSWORD} instead of NULL.  Maximum PASSWORD length is
      16.

@item -a, ---auth-type=@var{AUTHTYPE} @*
      Use @var{AUTHTYPE} instead of MD5.  Allowed values are NONE,
      MD2, MD5, and PLAIN.

@item -l, ---priv-level=@var{PRIVILEGE-LEVEL} @*
      Use this @var{PRIVILEGE-LEVEL} instead of USER.  Allowed values
      are CALLBACK, USER, OPERATOR, ADMIN and OEM.

@item -?, ---help @*
      Give this help list.

@item ---usage @*
      Give a short usage message.

@item -V, ---version @*
      Print program version.

@item -i, ---info @*
      Show SEL info

@item -x, ---hex-dump@var{=FILE} @*
      Output a hexadecimal dump of the SEL

@item -c, ---delete-all @*
      Delete all records in SEL

@item -d, ---delete=@var{REC-LIST} @*
      Delete REC-LIST in SEL

@item --delete-range=@var{START-END} @*
      Delete records from START to END in SEL

@item -f, ---flush-cache @*
      Flush SDR cache.

@end itemize

@node ipmi-sel sample output,  , ipmi-sel options, ipmi-sel
@section ipmi-sel sample output

@example
www:~# ipmi-sel 
3044:02-May-2005 16:00:30:Power Unit #1:Power Unit Failure detected
3064:31-Dec-1969 16:00:02:Power Unit #1:AC lost
3084:31-Dec-1969 16:00:02:Power Unit #1:AC lost
3104:31-Dec-1969 16:00:42:Platform Chassis Intrusion #5:LAN Leash Lost (system is unplugged from LAN):Network controller #15
3124:31-Dec-1969 16:00:49:Platform Chassis Intrusion #5:LAN Leash Lost (system is unplugged from LAN):Network controller #15
3144:04-May-2005 16:56:00:System Firmware #6:System Firmware Error (POST Error):OEM code = 09h:OEM code = 01h
3164:04-May-2005 16:56:02:System Event #8:OEM System Boot Event
3184:04-May-2005 17:07:58:Platform Chassis Intrusion #5:LAN Leash Lost (system is unplugged from LAN):Network controller #15
3204:04-May-2005 17:08:05:Platform Chassis Intrusion #5:LAN Leash Lost (system is unplugged from LAN):Network controller #15
3224:18-May-2005 08:55:38:System Firmware #6:System Firmware Error (POST Error):OEM code = 09h:OEM code = 01h
3244:18-May-2005 08:55:40:System Event #8:OEM System Boot Event
3264:16-Jun-2005 10:49:27:System Firmware #6:System Firmware Error (POST Error):OEM code = 09h:OEM code = 01h
3284:16-Jun-2005 10:49:29:System Event #8:OEM System Boot Event
3304:05-Jul-2005 10:10:56:System Firmware #6:System Firmware Error (POST Error):OEM code = 09h:OEM code = 01h
3324:05-Jul-2005 10:10:58:System Event #8:OEM System Boot Event
3344:25-Oct-2005 14:55:39:System Event #8:OEM System Boot Event
3364:25-Oct-2005 15:16:58:System Event #8:OEM System Boot Event
3384:25-Oct-2005 15:58:58:System Event #8:OEM System Boot Event
3404:02-Nov-2005 16:07:13:System Firmware #6:System Firmware Error (POST Error):OEM code = 09h:OEM code = 01h
@end example

@node bmc-watchdog, ipmipower, ipmi-sel, Top
@chapter bmc-watchdog
@pindex bmc-watchdog
@command{bmc-watchdog} is a daemon and configuration utility for BMC
watchdog timer.  When run as a daemon, it periodically resets the timer
so that, should the system lock up, the BMC can perform an appropriate
emergency recovery action. 

The bmc-watchdog tool typically executes as a cronjob or daemon to
manage the watchdog timer.  A user must be root in order to run
bmc-watchdog.  

@menu
* Watchdog theory::             BMC Watchdog Theory.
* bmc-watchdog options::        Command-line arguments.
* bmc-watchdog example::        @command{bmc-watchdog} example.
* bmc-watchdog known issues::   Known issues with the @command{bmc-watchdog}.
@end menu

@node Watchdog theory, bmc-watchdog options, bmc-watchdog, bmc-watchdog
@section BMC Watchdog Theory

A BMC watchdog timer is part of the Intelligent Platform Management
Interface (@acronym{IPMI}) specification and is only available to BMCs that are
compliant with @acronym{IPMI}@.  When a BMC watchdog timer is started, it begins
counting down to zero from some positive number of seconds.  When the
timer hits zero, the timer will execute a pre-configured pre-timeout
interrupt and/or timeout action.

In order to stop the pre-timeout interrupt or timeout action from
being generated, the watchdog timer must be periodically reset back to
its initial beginning value.

The BMC watchdog timer automatically stops itself when the machine is
rebooted.  Therefore, when a machine is brought up, the BMC watchdog
timer must be setup again before it can be used.

Typically, a BMC watchdog timer is used to automatically reset a
machine that has crashed.  When the operating system first starts up,
the BMC timer is set to its initial countdown value.  At periodic
intervals, when the operating system is functioning properly, the
watchdog timer can be reset by the OS or a userspace program.  Thus,
the timer never counts down to zero.  When the system crashes, the
timer cannot be reset by the OS or userspace program.  Eventually, the
timer will countdown to zero and reset the machine.

@node bmc-watchdog options, bmc-watchdog example, Watchdog theory, bmc-watchdog
@section command-line arguments

@menu
* bmc-watchdog general options::  General command-line arguments.
* bmc-watchdog command options::  Command command-line arguments.
* bmc-watchdog set options::    Set command-line arguments.
* bmc-watchdog start options::  Start command-line arguments.
* bmc-watchdog daemon options::  Daemon command-line arguments.
@end menu

@node bmc-watchdog general options, bmc-watchdog command options, bmc-watchdog options, bmc-watchdog options
@subsection bmc-watchdog general options
The following commands are available to bmc-watchdog.
@itemize @bullet
The following options can be used by any command.

@item -h, ---help @*
      Display the help menu.  If a specific command (@option{--set},
@option{--get}, @option{--reset}, @option{--start}, @option{--stop},
@option{--clear}, or @option{--daemon}) is listed on the command line,
only the specific options for that command will be listed.

@item -v, ---version @*
      Display the version information.

@item -I @var{string}, ---driver-type=@var{string} @*
      Identify the IPMI driver type to use.  The available driver
types are KCS and SSIF.  If not specified, @command{bmc-watchdog} will
attempt both.

@item -o @var{int}, ---driver-address=@var{int} @*
      Identify the System Base Address for the IPMI Driver.  If not
specified, @command{bmc-watchdog} will attempt to probe for the
system's default address.  If the probe fails, the IPMI defined
default will be used.  If the io-port number is prefixed with a
``0x'', it is assumed to be a base 16 integer.  Otherwise, it is
assumed to be a base 10 integer.

@item -R @var{int}, --reg-space=@var{int} @*
      Specify base address register spacing. If not specified,
@command{bmc-watchdog} will attempt to probe for the system's default
register spacing.  If the probe fails, the IPMI defined default will
be used.

@item -E @var{string}, --driver-device=@var{string} @*
      Identify the driver device path the IPMI driver should use.  It
not specified, a default path will be assumed.

@item -f @var{string}, ---logfile=@var{string} @*
      Specify an alternate logfile from the default of
@file{/var/log/freeipmi/bmc-watchdog.log}@. 
@cindex bmc-watchdog.log

@item -n, ---no-logging
      Turns off all logging done by bmc-watchdog.
@end itemize

@node bmc-watchdog command options, bmc-watchdog set options, bmc-watchdog general options, bmc-watchdog options
@subsection bmc-watchdog command options
The following commands are available to bmc-watchdog.
@itemize @bullet
@item -s, ---set @*
       Set BMC Watchdog Configuration.  BMC watchdog timer
configuration values can be set using the set command options listed
below under @ref{bmc-watchdog set options}@.  If a particular configuration
parameter is not specified on the command line, the current
configuration of that parameter will not be changed.

@item -g, ---get @*
      Get BMC watchdog configuration and state.  The current
configuration and state is printed to standard output.

@item -r, ---reset @*
      Reset BMC watchdog timer.

@item -t, ---start @*
      Start BMC watchdog timer identical to ---reset command when the
timer is stopped.  Does nothing if the timer is currently running.

@item -y, ---stop @*
      Stop BMC watchdog timer.  Stops the current timer.

@item -c, ---clear @*
      Clear BMC watchdog configuration.  Clears all configuration
values for the watchdog timer, except for timer use, which is kept at
its current value.

@item -d, ---daemon @*
      Run @command{bmc-watchdog} as a daemon.  Configurable BMC
watchdog timer options are listed below under @ref{bmc-watchdog daemon options}@.
The configuration values are set once, then the daemon will reset the
timer at specified periodic intervals.  Every time the BMC watchdog
timer is reset, a log entry will be generated in the
@file{bmc-watchdog} log.  The default log is stored at
@file{/var/log/freeipmi/bmc-watchdog.log}@.  The daemon can be stopped
using the @option{--stop} command, @option{--clear} command, or by setting
the @samp{stop_timer} flag on the @option{--set} command.
@end itemize

@node bmc-watchdog set options, bmc-watchdog start options, bmc-watchdog command options, bmc-watchdog options
@subsection bmc-watchdog set options
The following options can be used by the set command to set or clear
various BMC watchdog configuration parameters. 

@itemize @bullet
@item -u @var{int}, ---timer-use=@var{int} @*
      Set timer use.  The timer use value can be set to one of the
following:
@example
      @samp{1} = BIOS FRB2 
      @samp{2} = BIOS POST 
      @samp{3} = OS_LOAD
      @samp{4} = SMS OS
      @samp{5} = OEM
@end example

@item -m @var{int}, ---stop-timer=@var{int} @*
      Set stop timer flag.  A flag value of @samp{0} stops the current
BMC watchdog timer.  A value of @samp{1} doesn't turn off the current
watchdog timer.

@item -l @var{int}, ---log=@var{int} @*
      Set log flag.  A flag value of @samp{0} turns logging on.  A value
      of @samp{1} turns logging off.

@item -a @var{int}, ---timeout-action=@var{int} @*
      Set timeout action.  The timeout action can be set to one of the
following:  
@example
      @samp{0} = No action
      @samp{1} = Hard Reset
      @samp{2} = Power Down
      @samp{3} = Power Cycle
@end example

@item -p @var{int}, ---pre-timeout-interrupt=@var{int} @*
      Set pre-timeout interrupt.  The pre timeout interrupt can be set
to one of the following: 
@example
      @samp{0} = None
      @samp{1} = SMI
      @samp{2} = NMI
      @samp{3} = Messaging Interrupt
@end example

@item -z @var{secs}, ---pre-timeout-interval=@var{secs} @*
      Set pre-timeout interval in seconds.

@item -F, ---clear-bios-frb2 @*
      Clear BIOS FRB2 Timer Use flag.

@item -P, ---clear-bios-post @*
      Clear BIOS POST Timer Use flag.

@item -L, ---clear-os-load @*
      Clear OS Load Timer Use flag.

@item -S, ---clear-sms-os @*
      Clear SMS/OS Timer Use flag.

@item -O, ---clear-oem @*
      Clear OEM Timer Use Flag.

@item -i @var{secs}, ---initial-countdown=@var{secs} @*
      Set initial countdown in seconds.

@item -w, ---start-after-set @*
      Start timer after set command if timer is stopped.  This is
typically used when bmc-watchdog is used as a cronjob.  This can be
used to automatically start the timer after it has been set the first
time.

@item -x, ---reset-after-set @*
      Reset timer after set command if timer is running.

@item -j, ---start-if-stopped @*
      Don't execute set command if timer is stopped, just start
timer. 

@item -k, ---reset-if-running @*
      Don't execute set command if timer is running, just reset
timer.  This is typically used when bmc-watchdog is used as a cronjob.
This can be used to reset the timer after it has been initially
started.
@end itemize

@node bmc-watchdog start options, bmc-watchdog daemon options, bmc-watchdog set options, bmc-watchdog options
@subsection bmc-watchdog start options
The following options can be used by the start command.

@itemize @bullet
@item -G @var{int}, ---gratuitous-arp=@var{int} @*
       Suspend or don't suspend gratuitous ARPs while the BMC timer is
running.  A flag value of @samp{1} suspends gratuitous ARPs.  A value of
@samp{0} will not suspend gratuitous ARPs.  If this option is not
specified, gratuitous ARPs will not be suspended.

@item -A @var{int}, ---arp-response=@var{int} @*
      Suspend or don't suspend BMC-generated ARP responses while the
BMC timer is running.  A flag value of @samp{1} suspends ARP responses.
A value of @samp{0} will not suspend ARP responses.  If this option is
not specified, ARP responses will not be suspended.
@end itemize

@node bmc-watchdog daemon options,  , bmc-watchdog start options, bmc-watchdog options
@subsection bmc-watchdog daemon options
The following options can be used by the daemon command to set the
initial BMC watchdog configuration parameters. 

@itemize @bullet
@item -u @var{int}, ---timer-use=@var{int} @*
      Set timer use.  The timer use value can be set to one of the
following:
@example
      @samp{1} = BIOS FRB2 
      @samp{2} = BIOS POST 
      @samp{3} = OS_LOAD
      @samp{4} = SMS OS
      @samp{5} = OEM
@end example

@item -l @var{int}, ---log=@var{int} @*
      Set Log Flag.  A flag value of @samp{0} turns logging on.  A
value of @samp{1} turns logging off.

@item -a @var{int}, ---timeout-action=@var{int} @*
      Set timeout action.  The timeout action can be set to one of the
following:
@example
      @samp{0} = No action
      @samp{1} = Hard Reset
      @samp{2} = Power Down
      @samp{3} = Power Cycle
@end example

@item -p @var{int}, ---pre-timeout-interrupt=@var{int} @*
      Set pre-timeout interrupt.  The pre timeout interrupt can be set
to one of the following:
@example
      @samp{0} = None
      @samp{1} = SMI
      @samp{2} = NMI
      @samp{3} = Messaging Interrupt
@end example

@item -z @var{secs}, ---pre-timeout-interval=@var{secs} @*
      Set pre-timeout interval in seconds.

@item -F, ---clear-bios-frb2 @*
      Clear  BIOS FRB2 Timer Use flag.

@item -P, ---clear-bios-post @*
      Clear BIOS POST Timer Use flag.

@item -L, ---clear-os-load @*
      Clear OS Load Timer Use flag.

@item -S, ---clear-sms-os @*
      Clear SMS/OS Timer Use flag.

@item -O, ---clear-oem @*
      Clear OEM Timer Use flag.

@item -i @var{secs}, ---initial-countdown=@var{secs} @*
      Set initial countdown in seconds.

@item -G @var{int}, ---gratuitous-arp=@var{int} @*
      Suspend or don't suspend gratuitous ARPs while the BMC timer is
running.  A flag value of @samp{1} suspends gratuitous ARPs.  A value
of @samp{0} will not suspend gratuitous ARPs.  If this option is not
specified, gratuitous ARPs will not be suspended.

@item -A @var{int}, ---arp-response=@var{int} @*
      Suspend or don't suspend BMC-generated ARP responses while the
BMC timer is running.  A flag value of @samp{1} suspends ARP responses.
A value of @samp{0} will not suspend ARP responses.  If this option is
not specified, ARP responses will not be suspended.

@item -e, ---reset-period
      Time interval to wait before resetting timer.  The default is
@samp{60} seconds.
@end itemize

@node bmc-watchdog example, bmc-watchdog known issues, bmc-watchdog options, bmc-watchdog
@section bmc-watchdog example
Setup a bmc-watchdog daemon that resets the machine after 
@samp{15 minutes} (900 seconds) if the OS has crashed.
@footnote{see default @command{bmc-watchdog} rc script
@file{/etc/init.d/bmc-watchdog} a more complete example.}

@example
debian-ia64:~# bmc-watchdog -d -u 4 -p 0 -a 1 -i 900
debian-ia64:~# ps -C bmc-watchdog
  PID TTY          TIME CMD
 1035 ?        00:00:00 bmc-watchdog
debian-ia64:~# 
@end example

@node bmc-watchdog known issues,  , bmc-watchdog example, bmc-watchdog
@section bmc-watchdog known issues
@command{bmc-watchdog} may fail to reset the watchdog timer if it is
not  scheduled  properly.  It is always recommended that bmc-watchdog
be executed with a high scheduling priority.

On some machines, the hardware based SMI Handler may disable a
processor after a watchdog timer timeout if the timer use is set to
something other than SMS/OS.

@node ipmipower, ipmiping, bmc-watchdog, Top
@chapter IPMI power control utility
@pindex ipmipower
Remote out-of-band chassis control utility to perform power-up,
power-down, power-cycle, hard-reset, pulse-diagnostics-interrupt and
OS soft shutdown operations.

PowerMan @uref{http://www.llnl.gov/linux/powerman/} now supports
@command{ipmipower} as a remote power control device. 

Whenever a power command (@option{--on}, @option{--off},
@option{--cycle}, @option{--reset}, @option{--stat}, @option{--pulse},
or @option{--soft}) is specified on the command-line,
@command{ipmipower} will run in non-interactive mode.
@command{ipmipower} will attempt to run the power command on all
hostnames listed on the command line then exit. 

If no power commands are specified on the command line,
@command{ipmipower} will run in interactive mode.  Interactive mode
gives the user a command-line interface to enter various commands.
Details of the interactive command line interface can be found under
@ref{ipmipower interactive commands} section.

@menu
* ipmipower options::           Command-line arguments. 
* ipmipower configuration file::  Configuration file.
* ipmipower interactive commands::  Interactive commands.
* Host ranges::                 Host range specificaiton.
* ipmipower example::           ipmipower example.
* Use with powerman::           PowerMan integration.
* ipmipower workarounds::       Workarounds.
* ipmipower known issues::      Known issues.
@end menu

@node ipmipower options, ipmipower configuration file, ipmipower, ipmipower
@section Command-line arguments

@menu
* ipmipower basic options::     Basic options.
* ipmipower advanced options::  Advanced options.
* ipmipower network options::   Network options.
@end menu

@node ipmipower basic options, ipmipower advanced options, ipmipower options, ipmipower options
@subsection ipmipower basic options
The following options are basic options for ipmipower.

@itemize @bullet
         @item -h, ---hostnames @var{host1},@var{host2},@dots{} @*
      The list of hostname addresses to be controlled by
@command{ipmipower}@. The hostnames must resolve to the IP address of
the NIC connected to the remote host BMC.  If hostnames do not resolve
to proper BMC IP addresses,  RMCP ping messages will not discover the
remote host or power commands will time out.  This option is required
if a power command (@option{--on}, @option{--off}, @option{--cycle},
@option{--reset}, or @option{--stat}, @option{--pulse},
@option{--soft}) is specified on the command-line.  Hostnames may be
specified in a range format; see @ref{Host ranges} section.

@item -u, ---username @var{name} @*
      Sets the username to use when authenticating with the BMC.  The
user must have @var{operator} or @var{administrator} privilege to run
the  @option{--on}, @option{--off}, @option{--reset},
@option{--cycle}, @option{--pulse}, or @option{--soft} power control
commands.  The user needs only @var{user} privileges to determine the
status of the machine through @option{--stat}@.  If not specified, a
null username (Anonymous Login @samp{User ID 1}) is assumed.

@item -p, ---password @var{pw} @*
      Sets the @var{password} to use when authenticating with the BMC.
If not specified, a null password is assumed.

@item -k, ---k-g @var{str} @*
      Sets the @var{K_g} BMC Key when authenticating with the BMC for
ipmi 2.0.  If not specified, a null key is assumed.

@item -n, ---on @*
      Power on the target hosts.

@item -f, ---off @*
      Power off the target hosts.

@item -c, ---cycle @*
      Power cycle the target hosts.

@item -r, ---reset @*
      Reset the target hosts.

@item -s, ---stat @*
      Get power status of the target hosts.

@item -j, ---pulse @*
      Send power diagnostic interrupt to target hosts.

@item -m, ---soft @*
      Initiate a soft-shutdown of the OS via ACPI.

@item -H, ---help @*
      Display the help menu and exit.

@item -V, ---version @*
      Display the version information and exit.

@item -C, ---config @var{file} @*
      Specify alternate configuration file.
@end itemize

@node ipmipower advanced options, ipmipower network options, ipmipower basic options, ipmipower options
@subsection ipmipower advanced options
The following advanced options are used to change the behavior of
ipmipower.

@itemize @bullet
@item -a, ---authentication-type @var{str} @*
      Sets the authentication type to use with @command{ipmipower}@.
The currently available authentication types are:
@example
        @samp{auto} => (default)
        @samp{none}
        @samp{straight_password_key} 
        @samp{md2}
        @samp{md5}
@end example

@item -l, ---privilege @var{str} @*
      Sets the privilege type to use with @command{ipmipower}@.
@example
        @samp{auto} => (default)
        @samp{user}
        @samp{operator} 
        @samp{admin}
@end example

@item -R, ---ipmi-version @var{version} @*
      Sets the IPMI protocol version to use with @command{ipmipower}@.
@example
        @samp{auto} => (default)
        @samp{1.5}
        @samp{2.0} 
@end example

@item -T, ---cipher-suite-id @var{id} @*
      Set the IPMI 2.0 Cipher Suite ID to use.  The Cipher Suite ID identifies
a set of authentication, integrity, and confidentiality algorithms to
use for IPMI 2.0 communication.
@example
        @samp{auto} => (default)
        @samp{0}
        @samp{1}
        @samp{2}
        @samp{3}
        @samp{6}
        @samp{7}
        @samp{8}
        @samp{11}
        @samp{12}
@end example

@item -g,  ---on-if-off @*
      The @acronym{IPMI} specification does not require the @command{cycle} or
@command{reset} commands to turn on a machine that is currently
powered off.  This option will force @command{ipmipower} to issue a
power on command instead of a power cycle or hard reset command if the
remote machine's power is currently off.

@item -o, ---outputtype @var{str} @*
       Sets the output type to use with @command{ipmipower}@.  The
currently available output types are: 
@example
        @samp{none}
        @samp{newline}    => (default)
        @samp{hostlist}
@end example

Hostlist output can be used to shorten output if the number of nodes
in your cluster is quite large.  However, hostlist output will only
output after the slowest node has completed its power control
operation. 

@item -P,  ---force-permsg-authentication @*
      Forces @command{ipmipower} to use IPMI per message authentication
regardless of what is advertised by the remote machine.  This option
has been specifically implemented to get around a compliance issue.

@item -S,  ---accept-session-id-zero @*
      Forces @command{ipmipower} to accept packets with a session id
of zero.  This option has been specifically implemented to get around
a compliance issue.

@item -U,  ---check-unexpected-authcode @*
      Forces @command{ipmipower} to check packet authcodes even if no
authcode should be received.  This option has been specifically
implemented to get around a compliance issue.

@item -X,  ---intel-2-0-session @*
Modifies the IPMI 2.0 session protocol for non-compliant Intel
machines.

@end itemize

@node ipmipower network options,  , ipmipower advanced options, ipmipower options
@subsection ipmipower network options
The following options are used to change the behavior of the actual
@command{ipmipower} network protocol used. 

@itemize @bullet
@item -t, ---timeout @var{ms} @*
      Sets the @var{time-out} in milliseconds.  @command{ipmipower}
uses the @var{time-out} value to determine when to give up on a power
command.  If not specified, a default @var{time-out} of 20000
milliseconds (20 seconds) is used.

@item -y, ---retry-timeout @var{ms} @*
      Sets the retry-timeout in milliseconds.  The @acronym{IPMI} protocol sends
a series of packets back and forth to a remote host BMC in order to
perform a power control operation.  When a response to any individual
packet is not received after @var{retry-timeout} milliseconds,
@command{ipmipower} will retry sending that packet.  If not specified,
packet retransmissions will occur after @samp{400} milliseconds (0.4
seconds).  The value @var{ms} must be less than the time out length
specified with @option{--timeout}@.  Packet retransmissions can be
disabled by setting the @var{retry-timeout} length to @samp{0}@.

       Note how this option differs from the @option{--timeout} option
above.  The @option{--timeout} option refers to the entire amount of
time the @acronym{IPMI} protocol has to complete a power control operation.  The
@option{--retry} option refers to the amount of time any individual
packet within the @acronym{IPMI} protocol has to complete.

@item -b, ---retry-backoff-count @var{num} @*
      After every @var{retry-backoff-count} retransmissions,
@command{ipmipower} will increase the @var{retry-timeout} length by
another factor for the duration of the current power control
operation.  This is done to reduce network traffic and allow BMC
buffers to empty.  If not specified, @var{retry-backoff-count} is
@samp{8}@.  Retransmission backoff can be disabled by setting the retry
backoff count to @samp{0}@.

@item -i, ---ping-interval @var{ms} @*
@item -z, ---ping-timeout @var{ms} @*
      @command{ipmipower} will send RMCP ping discovery messages every
@var{ping-interval} milliseconds to discover all remote hosts and
confirm its support of @acronym{IPMI}@.  Power commands cannot be sent to a host
until it is discovered.  If a remote host does not respond within
@var{ping-timeout} milliseconds, a host will be considered
undiscovered and power commands will not be sent to it.  If not
specified, @var{ping-interval} is @samp{5000} milliseconds (5 seconds)
and @var{ping-timeout} is @samp{30000} milliseconds (30 seconds).
Ping discovery requests can be disabled by setting the ping interval
to @samp{0}@.  If ping discovery messages are disabled, power commands
will be attempted without knowledge of the host's existence or its
support of @acronym{IPMI}@.  The value of @var{ping-interval} must be less than
the @var{ping-timeout} length.  RMCP ping discovery messages are
automatically disabled in non-interactive mode.

@item -v, ---ping-packet-count @var{num} @*
@item -w, ---ping-percent @var{num} @*
      It is difficult to distinguish between a missing node and node
with a bad connection when using just RMCP pings and timeouts. For
example, if a link consistently drops 80% of the packets to a
particular node, a power control operation may have difficulty
completing, although a recent pong response makes ipmipower
believe the node exists and is functioning properly.  The
@option{--ping-packet-count} and  @option{--ping-percent} options
alleviate this problem.  @command{ipmipower} will monitor ping packets
in @var{ping-packet-count} chunks.  If @command{ipmipower} does not
receive a response to greater than @var{ping-percent} of those
packets, @command{ipmipower} will assume the link to this node is bad
and will not send power control operations to that node until the
connection is determined to be reliable.  If not specified,
@var{ping-packet-count} is @samp{10} and @var{ping-percent} is
@samp{50}@.  This heuristic can be disabled by setting either
@var{ping-packet-count} or @var{ping-percent} to @samp{0}@.  This
feature is not used if @var{ping-interval} is set to @samp{0}@.  Note
that the @option{--ping-percent} option takes an integer as an
argument, not a decimal.

@item -x, ---ping-consec-count @var{ping-consec-count} @*
      @var{ping-consec-count} is another measurement used to determine
if a node should be considered discovered, undiscovered, or with a bad
connection.  If a valid response was received from the last
@var{ping-consec-count} RMCP ping packets, a node will be considered
discovered, regardless if @var{ping-packet-count} and
@var{ping-percent} statistically consider the link to be unreliable.
If not specified, @var{ping-consec-count} is @samp{5}@.  This feature
can be disabled by setting @var{ping-consec-count} to @samp{0}@.  This
feature is not used if @var{ping-interval},
@option{--ping-packet-count}, or @option{--ping-percent} are set to
@samp{0}@.
@end itemize

@node ipmipower configuration file, ipmipower interactive commands, ipmipower options, ipmipower
@section ipmipower configuration file
The @command{ipmipower} configuration file can be used to set default
values to ipmipower when values aren't set on the command line.  This
allows users to avoid typing in a long list of command line options
everytime ipmipower is executed.  It can also be used to hide
usernames and passwords from the @command{ps} command. See
@ref{ipmipower known issues} for details.

By default, the configuration file is stored at
@file{/etc/ipmipower.conf}.  But users may select a different
configuration file at the command line through the @option{--config}
option.

The user can still override the configuration file values by
specifying the options on the command line.  The configuration file
does not stop a user from specifying certain options. 

@subsection Configuration options
The following are a list of configuration options that can be
specified in the configuration file.  Each configuration option must
be listed on a separate line.  Arguments for an option are separated
by any amount of whitespace.  Multiple arguments are also separated by
whitespace.  Comments can be marked by using the pound sign ("#")
character, and lines can be continued on the next using backslash
("\").

Note that it is possible to list the username and password in
the configuration file.  If this data is stored in a configuration
file, system administrators should limit access to this file.

@itemize @bullet
@item hostnames @var{host1} @var{host2} @var{host3} @dots{} @*

Specify the default hostnames.  Multiple hostnames or hostname ranges
can be specified by separating each range by whitespace.  See
@ref{Host ranges} for information on hostname ranges.  For example,
any of the following configuration listings would be acceptable:

@example
hostnames @var{host1} @var{host2} @var{host3} @var{foo1} @var{bar1}
hostnames @var{host1},@var{host2},@var{host3},@var{foo1},@var{bar1}
hostnames @var{host}[1-3] @var{foo1} @var{bar1}
hostnames @var{host}[1-3] @var{foo1},@var{bar1}
@end example

At most 64 hostnames or hostname ranges can be separted by
whitespace. 

@item username @var{username} @*
Specify the default @var{username} to use.

@item password @var{password} @*
Specify the default @var{password} to use.

@item k_g @var{k_g_str} @*
Specify the BMC key @var{K_g} to use.

@item authentication-type @var{authtype} @*
Specify the default authentication type to use.  @command{ipmipower}
currently supports the following authentication types: 

@example
        @samp{auto}
        @samp{straight_password_key}
        @samp{md2}
        @samp{md5}
@end example

@item privilege @var{privilege} @*
Specify the default privilege type to use.  @command{ipmipower}
currently supports the following privilege types: 

@example
        @samp{auto}
        @samp{user}
        @samp{operator}
        @samp{admin}
@end example

@item ipmi_version @var{ipmi_version} @*
Specify the default IPMI protocol version to use.  @command{ipmipower}
currently supports the following version types: 

@example
        @samp{auto}
        @samp{1.5}
        @samp{2.0}
@end example

@item cipher_suite_id @var{cipher_suite_id} @*
Specify the default Cipher Suite ID to use.  @command{ipmipower}
currently supports the following Cipher Suite IDs:

@example
        @samp{auto}
        @samp{0}
        @samp{1}
        @samp{2}
        @samp{3}
        @samp{6}
        @samp{7}
        @samp{8}
        @samp{11}
        @samp{12}
@end example

@item on-if-off enable|disable @*

@item outputtype @var{outputtype} @*
Specify the default outputtype type to use.  @command{ipmipower}
currently supports the following output types:  

@example
        @samp{none}
        @samp{newline}    => (default)
        @samp{hostlist}
@end example

@item force_permsg_authentication enable|disable @*

@item accept_session_id_zero enable|disable @*

@item accept_unexpected_authcode enable|disable @*

@item intel_2_0_session enable|disable @*

@item timeout @var{timeout} @*
Specify the @var{timeout} in ms.

@item retry-timeout @var{timeout} @*
Specify the retry @var{timeout} in ms.  See @ref{ipmipower} for an
explanation on the difference between this is the @var{timeout}
option. 

@item retry-backoff-count @var{num} @*
Specify the retry backoff count.

@item ping-interval @var{interval-length} @*
Specify the ping @var{interval-length} in ms.

@item ping-timeout @var{timeout} @*
Specify the ping @var{timeout} length in ms.

@item ping-packet-count @var{count} @*
Specify a new ping packet @var{count}.

@item ping-percent @var{num} @*
Specify a new ping percent.

@item ping-consec-count @var{count} @*
       Specify a new ping consec @var{count}.
@end itemize

@node ipmipower interactive commands, Host ranges, ipmipower configuration file, ipmipower
@section ipmipower interactive commands
@command{ipmipower} provides the following interactive commands at the
@samp{ipmipower>} prompt.  Before any @command{power} commands (@samp{on},
@samp{off}, @samp{cycle}, @samp{reset}, @samp{stat}, @samp{pulse}, or
@samp{soft}) can be used, hostnames must be configured into @command{ipmipower},
either through the command prompt or the @command{hostnames} command below.

@itemize @bullet
@item hostnames @var{str} @*
      Specify a new set of hosts, no @var{str} to unconfigure all hosts.

@item username @var{str} @*
      Specify a new username, no @var{str} for null username.

@item password @var{str} @*
      Specify a new password, no @var{str} for null password.

@item k_g @var{str} @*
      Specify a new k_g, no @var{str} for null.

@item on @var{host} @*
      Turns on all hosts, or only the specified host.

@item off @var{host} @*
      Turns off all hosts, or only the specified host.

@item cycle @var{host} @*
      Power cycle all hosts, or specified host.

@item reset @var{host} @*
      Hard reset all hosts or specified host.

@item stat @var{host} @*
      Queries power status for all hosts, or only the specified host.

@item pulse @var{host} @*
      Send pulse diagnostic interrupt to all hosts, or only the
specified host. 

@item soft @var{host} @*
      Initiate a soft-shutdown of the OS via ACPI  to  all  hosts,  or
     only the specified host.

@item help @*
      Display the help menu.

@item advanced @*
      Display the advanced help menu.

@item network @*
      Display the network help menu.

@item quit @*
      Quit ipmipower.

@item authentication_type @var{str} @*
      Specify a new authentication type:
@example
        @samp{none}
        @samp{straight_passwd_key}
        @samp{md2}
        @samp{md5}
@end example

@item privilege_type @var{str} @*
      Specify a new privilege type:
@example
        @samp{none}
        @samp{user}
        @samp{operator}
        @samp{admin}
@end example

@item ipmi_version @var{str} @*
      Specify a new IPMI version:
@example
        @samp{auto}
        @samp{1.5}
        @samp{2.0}
@end example

@item cipher_suite_id @var{str} @*
      Specify a new cipher suite id:
@example
        @samp{auto}
        @samp{0}
        @samp{1}
        @samp{2}
        @samp{3}
        @samp{6}
        @samp{7}
        @samp{8}
        @samp{11}
        @samp{12}
@end example

@item outputtype @var{str} @*
      Specify a new output type:
@example
        @samp{none}
        @samp{newline}
        @samp{hostlist}
@end example

@item force-permsg-authentication on|off @*

@item accept-session-id-zero on|off @*

@item check-unexpected-authcode on|off @*

@item intel-2-0-session on|off @*

@item config @*
      Output the current configuration.

@item timeout @var{ms} @*
      Specify a new timeout length.

@item retry-timeout @var{ms} @*
      Specify a new retry timeout length.

@item retry-backoff-count @var{num} @*
      Specify a new retry backoff count.

@item ping-interval @var{ms} @*
      Specify a new ping interval length.

@item ping-timeout @var{ms} @*
      Specify a new ping timeout length.

@item ping-packet-count @var{num} @*
      Specify a new ping packet count.

@item ping-percent @var{num} @*
      Specify a new ping percent.

@item ping-consec-count @var{num} @*
      Specify a new ping consec count.
@end itemize

@node Host ranges, ipmipower example, ipmipower interactive commands, ipmipower
@section Host ranges
As noted above, ipmipower accepts a range of hostnames in the general
form: prefix[n-m,l-k,...], where n < m and l < k, etc., as an
alternative to explicit comma separated lists of hosts.  This form
should not be confused with regular expression character classes (also
denoted by []).  For example, foo[19] does not represent foo1 or foo9,
but rather represents a degenerate range: foo19.

This range syntax is meant only as a convenience on clusters with a
prefixNN naming convention and specification of ranges should not be
considered necessary -- the list foo1,foo9 could be specified as
such, or by the range foo[1,9].

Some examples of range usage follow:
@example
        foo[01-05] instead of foo01,foo02,foo03,foo04,foo05
        foo[7,9-10] instead of foo7,foo9,foo10
        foo[0-3] instead of foo0,foo1,foo2,foo3
@end example

As a reminder to the reader, some shells will interpret brackets ([
and ]) for pattern matching.  Depending on your shell, it may be
necessary to enclose ranged lists within quotes.

@node ipmipower example, Use with powerman, Host ranges, ipmipower
@section ipmipower example

Determine the power status of foo[0-2] with null username and
password.
@example
        ipmipower -h foo[0-2] --stat
@end example

Determine the power status of foo[0-2] with non-null username and
password.
@example
        ipmipower -h foo[0-2] -u foo -p bar --stat
@end example

Hard reset nodes foo[0-2] with non-null username and password.
@example
        ipmipower -h foo[0-2] -u foo -p bar --reset
@end example

Hard reset the nodes configured in a configuration file.
@example
        ipmipower -C /etc/powerctrl.conf --reset
@end example

Example @command{ipmipower} session:
@example
debian-sid:~# ipmipower --hostnames debian-ia64 --password "rea1secret" --stat
debian-ia64: on
debian-sid:~# ipmipower --hostnames debian-ia64 --password "rea1secret" --off
debian-ia64: ok
debian-sid:~# ipmipower --hostnames debian-ia64 --password "rea1secret" --stat
debian-ia64: off
debian-sid:~# ipmipower --hostnames debian-ia64 --password "rea1secret" --on
debian-ia64: ok
debian-sid:~# 
@end example

@node Use with powerman, ipmipower workarounds, ipmipower example, ipmipower
@section Use with powerman
@cindex powerman
@pindex powerman
The @command{powerman} device configuration file @file{ipmipower.dev}
supplied with @command{powerman} 1.0.20 and beyond can be used to
control one or more instances of @command{ipmipower} in coprocess
mode. 

Due to deficiencies within @command{powerman}, the power control
operations @option{--on}, @option{--off}, @option{--cycle},
@option{--reset} will be reported as successful, despite any errors
that may occur.  The user should use the @option{--query} option to
ensure that all remote hosts were successfully powered on or off. 

It is recommend that the @option{--on-if-off} option be used with
@command{ipmipower} when it is used in conjunction with powerman.  This
will ensure @command{ipmipower} behaves similarly to other
@command{powerman} devices. 

@node ipmipower workarounds, ipmipower known issues, Use with powerman, ipmipower
@section ipmipower workarounds
As can be expected, with so many different vendors implementing their
own IPMI solutions, different vendors may implement their IPMI
protocols slightly differently.  The following lists the handful of
compliance issues discovered and the workarounds currently used in
@command{ipmipower}.

When possible, the workarounds have been implemented so they will be
transparent to the user.  However, some will require command line
options be set due to issues with code logic or security.  The
workarounds listed below are listed in the order of their
implementation.  Therefore, workarounds implemented earlier may have
solved problems for other vendors.

Note that the following only indicates the hardware that a problem was
discovered on.  Newer versions of a vendors firmware may fix the
problems indicated below.  Similar machines from vendors may or may
not exhibit the same problems.

Intel SR870BN4: BMCs would not respond to retransmissions of a Get
Session Challenge Request if a previous Get Session Challenge response
was lost.  Resolved by sending retransmitted Get Session Challenge
requests from a different source port.

Tyan S2882 with m3289 BMC: After the IPMI session is brought up,
packet responses return empty session IDs to the client.  In order to
work around this issue, the @option{-S} (@option{--accept-ses-
sion-id-zero}) option must be set.  The option will allow empty
session IDs to be accepted by the client.  This problem is apparently
fixed in later firmware releases.

Dell PowerEdge 2850,SC1425: When Per-Message Authentication is
disabled, packet responses contain non-null authentication data (when
it should in fact be null).  In order to work around this issue, the
@option{-U} (@option{--check-unexpected-authcode}) option must be set.
The option will allow unexpected non-null authcodes to be checked as
though they were expected.  Fix con- firmed on upgraded firmware.

Intel SE7520JR2 with National Semiconductor PC87431M mBMC: The
activate session response and close session response packets have
invalid sequence numbers.  Specific workaround no longer required in
later revisions of @command{ipmipower}.

IBM eServer 325: The remote BMC will advertise that Per Message
Authentication is disabled, but actually require it for the protocol.
In order to work around this issue, the @option{-P}
(@option{--force-permsg-authentication}) option must be set.  The
option will force Per Message Authentication to be used no matter what
is advertised by the remote BMC.

Intel SE7520AF2 with Intel Server Management Module (Professional
Edition): There are a num- ber of Intel IPMI 2.0 bugs which can be
worked around using the the @option{-X} (@option{--intel-2-0-session})
option.  The workrarounds include padding of usernames, automatic
acceptance of a RAKP 4 response integrity check when using the
integrity algorith MD5-128, and password truncation if the
authentication algorithm is HMAC-MD5-128.

@node ipmipower known issues,  , ipmipower workarounds, ipmipower
@section Known issues with the ipmipower command
In order to prevent brute force attacks, some BMCs will @emph{lock up}
after a number of username, password, or privilege errors.  There is
no known way to cleanly deal with a @emph{locked up} BMC.  The best
option is to simply @strong{wait awhile}@.

On certain operating systems, if you input your username and password
on the command line, the username and password may be discovered by
other users when using the @command{ps} command or looking in the
@file{/proc} file system.  The most secure solution is to enter the
username and password while in interactive mode.  If administrators do
not wish to type in their username and password at the interactive
prompt, they can be listed in a configuration file, in which the
access to this file can be limited. 

@acronym{IPMI} specifications do not require BMCs to perform a power
control operation before returning a completion code to the caller.
Therefore, it is possible for ipmipower power status queries to
initially return information other than what you are expecting.  For
example, if a @samp{power off} operation is performed, a BMC may
return a successful completion-code to ipmipower before the
@samp{power off} operation is actually performed.  Subsequent power
status queries may return @samp{on} for several seconds, until the BMC
actually performs the @samp{power off} operation.

@node ipmiping, rmcpping, ipmipower, Top
@chapter ipmiping
@pindex ipmiping
@acronym{IPMI} discovery and reachability test tool. 

@command{ipmiping} uses the @acronym{IPMI} @command{Get Authentication
Capabilities} request datagram to elicit an @acronym{IPMI} @command{Get
Authentication Capabilities} response from a remote host.  The utility
can be used to verify if a remote host supports @acronym{IPMI}@.

Returns @samp{0} to the environment if it receives at least @samp{1}
response from the remote host.  Otherwise, it exists with a value of
@samp{1}@. 

@menu
* ipmiping options::            Command-line arguments.
* ipmiping example::            @command{ipmiping} example.
* ipmiping known issues::       Known issues with the @command{ipmi-ping}
@end menu

@node ipmiping options, ipmiping example, ipmiping, ipmiping
@section command-line arguments
@subsection Synopsis
ipmiping [OPTIONS] destination

The following options are available
@itemize @bullet
@item -h @*
      Display the help menu.

@item -V @*
      Display the version information.

@item -c @var{count} @*
      Stop after sending @var{count} request packets.

@item -i @var{interval} @*
      Wait @var{interval} seconds between sending each packet.  The
default is to wait for one second between each packet.

@item -I @var{interface-address} @*
      Set source address to specified
@var{interface-address}@. Argument may be numeric IP address or name of
device. 

@item -t @var{timeout} @*
      Time to wait for a response, in seconds. Default is five
seconds. 

@item -r @var{version} @*
      Specify IPMI  protocol  version.
@example
        @samp{1.5}
        @samp{2.0}
@end example

@item -s @var{num} @*
      Specify an initial starting sequence number.

@item -v @*
      Verbose Display.

@end itemize

@node ipmiping example, ipmiping known issues, ipmiping options, ipmiping
@section ipmiping example

Example: Test the BMC reachability of host @samp{debian-ia64} using
@acronym{IPMI} protocol.
@example
debian-sid:~# ipmiping debian-ia64
ipmiping debian-ia64 (192.168.1.60)
response received from 192.168.1.60: rq_seq=6
response received from 192.168.1.60: rq_seq=7
response received from 192.168.1.60: rq_seq=8
response received from 192.168.1.60: rq_seq=9
response received from 192.168.1.60: rq_seq=10
response received from 192.168.1.60: rq_seq=11
--- ipmiping debian-ia64 statistics ---
6 requests transmitted, 6 responses received in time, 0.0% packet loss
@end example

Example: Test the BMC reachability of host @samp{debian-ia64} in
verbose mode. 
@example
debian-sid:~# ipmiping -v debian-ia64
ipmiping debian-ia64 (192.168.1.60)
response received from 192.168.1.60: rq_seq=45, auth: none=clear md2=clear md5=set passwd=clear oem=clear anon=clear null=clear non-null=set user=clear permsg=clear
response received from 192.168.1.60: rq_seq=46, auth: none=clear md2=clear md5=set passwd=clear oem=clear anon=clear null=clear non-null=set user=clear permsg=clear
response received from 192.168.1.60: rq_seq=47, auth: none=clear md2=clear md5=set passwd=clear oem=clear anon=clear null=clear non-null=set user=clear permsg=clear
response received from 192.168.1.60: rq_seq=48, auth: none=clear md2=clear md5=set passwd=clear oem=clear anon=clear null=clear non-null=set user=clear permsg=clear
response received from 192.168.1.60: rq_seq=49, auth: none=clear md2=clear md5=set passwd=clear oem=clear anon=clear null=clear non-null=set user=clear permsg=clear
--- ipmiping debian-ia64 statistics ---
5 requests transmitted, 5 responses received in time, 0.0% packet loss
@end example

Example: Test the BMC reachability of host @samp{debian-ia64} by
sending exactly 2 packets.
@example
debian-sid:~# ipmiping -c 2 debian-ia64
ipmiping debian-ia64 (192.168.1.60)
response received from 192.168.1.60: rq_seq=30
response received from 192.168.1.60: rq_seq=31
--- ipmiping debian-ia64 statistics ---
2 requests transmitted, 2 responses received in time, 0.0% packet loss
debian-sid:~# 
@end example

@node ipmiping known issues,  , ipmiping example, ipmiping
@section ipmiping known issues
It has been observed that some remote BMCs can get @emph{confused} and
delay packet responses if duplicate packets are sent in succession
very quickly.  For example, this could happen if the user repeatedly
executes @command{ipmiping -c 1 -s X destination} very quickly.  There is
no known way to cleanly deal with a @emph{confused} BMC.  The best
option is to simply @strong{wait awhile}@.

@node rmcpping, Trouble-shooting, ipmiping, Top
@chapter rmcpping
@pindex rmcpping
RMCP/@acronym{IPMI} discovery and reachability test tool.

@command{rmcpping} uses the RMCP ping request datagram to elicit an
RMCP pong response from a remote host.  The utility can be used to
verify if a remote host supports RMCP or @acronym{IPMI}@.

Returns 0 to the environment if it receives at least @samp{1}
response from the remote host.  Otherwise, it exits with a value of
@samp{1}@.

@menu
* rmcpping options::            Command-line arguments.
* rmcpping example::            @command{rmcpping} example.
* rmcpping known issues::       Known issues with the @command{rmcpping}@.
@end menu

@node rmcpping options, rmcpping example, rmcpping, rmcpping
@section Command-line arguments

@subsection Synopsis
rmcpping [OPTIONS] destination
@itemize
@item -h @*
      Display the help menu.

@item -V @*
      Display the version information.

@item -c @var{count} @*
      Stop after sending count ping packets.

@item -i @var{interval} @*
      Wait @var{interval} seconds between sending each packet.  The
default is to wait for one second between each packet normally.

@item -I @var{interface-address} @*
      Set source address to specified @var{interface-address}@.
Argument may be numeric IP address or name of device.

@item -t @var{timeout} @*
      Time to wait for a response, in seconds.  Default is @samp{5}
seconds. 

@item -v
      Verbose display.

@item -s @var{num} @*
      Specify an initial starting sequence number.
@end itemize

@node rmcpping example, rmcpping known issues, rmcpping options, rmcpping
@section rmcpping example
Example: Test the BMC reachability of host @samp{debian-ia64} using
RMCP protocol. 

@example
debian-sid:~# rmcpping debian-ia64
rmcpping debian-ia64 (192.168.1.60)
pong received from 192.168.1.60: msg_tag=0
pong received from 192.168.1.60: msg_tag=1
pong received from 192.168.1.60: msg_tag=2
pong received from 192.168.1.60: msg_tag=3
pong received from 192.168.1.60: msg_tag=4
pong received from 192.168.1.60: msg_tag=5
pong received from 192.168.1.60: msg_tag=6
pong received from 192.168.1.60: msg_tag=7
pong received from 192.168.1.60: msg_tag=8
--- rmcpping debian-ia64 statistics ---
9 pings transmitted, 9 pongs received in time, 0.0% packet loss
@end example

Example: Test the BMC reachability of host @samp{debian-ia64} in
verbose mode.
@example
debian-sid:~# rmcpping -v debian-ia64
rmcpping debian-ia64 (192.168.1.60)
pong received from 192.168.1.60: msg_tag=0, ipmi supported
pong received from 192.168.1.60: msg_tag=1, ipmi supported
pong received from 192.168.1.60: msg_tag=2, ipmi supported
pong received from 192.168.1.60: msg_tag=3, ipmi supported
pong received from 192.168.1.60: msg_tag=4, ipmi supported
--- rmcpping debian-ia64 statistics ---
5 pings transmitted, 5 pongs received in time, 0.0% packet loss
@end example

Example: Test the BMC reachability of host @samp{debian-ia64} by
sending exactly 2 packets.
@example
debian-sid:~# rmcpping -c 2 debian-ia64
rmcpping debian-ia64 (192.168.1.60)
pong received from 192.168.1.60: msg_tag=0
pong received from 192.168.1.60: msg_tag=1
--- rmcpping debian-ia64 statistics ---
2 pings transmitted, 2 pongs received in time, 0.0% packet loss
debian-sid:~# 
@end example

@node rmcpping known issues,  , rmcpping example, rmcpping
@section rmcpping known issues
It has been observed that some remote BMCs can get @emph{confused} and
delay packet responses if duplicate packets are sent in succession
very quickly.  For example, this could happen if the user repeatedly
executes @command{rmcpping -c 1 -s X destination} very quickly.  There is
no known way to cleanly deal with a @emph{confused} BMC.  The best
option is to simply @strong{wait awhile}@.

@node Trouble-shooting, Contact us, rmcpping, Top
@chapter Trouble-shooting

@menu
* Ports conflict::              Fencing @acronym{IPMI} @acronym{IP} ports.
* IPC key conflict::            Non-unique IPC key.
* Kernel Driver conflict::      Kernel Driver conflicts.
@end menu

@node Ports conflict, IPC key conflict, Trouble-shooting, Trouble-shooting
@section Fencing @acronym{IPMI} @acronym{IP} ports
@cindex Ports conflict
@cindex Fencing BMC
@example
Append the following to /etc/services:
# BMC IPMI/RMCP services
rmcp    623/udp         # Aux Bus Shunt (Primary RMCP Port)
rmcps   664/udp         # Secure Aux Bus (Secondary RMCP Port)
@end example
@acronym{BMC} internally (at hardware level) uses the above mentioned
ports for sending @acronym{RMCP}/@acronym{IPMI} packets . To avoid any
conflit with the @acronym{BMC}, Operating System should make sure no
other applications or services uses these ports for communication.
One easy way to do this is to start a simple daemon at the boot time
that opens these ports but never uses them. 

Most common victims to this issue are Remote-shell (rsh) and NIS
services. You will notice ``time out'' errors under heavy load, when
these services run over the @acronym{BMC} reserved ports.

Secure connections to BMC port 664 is not enabled on most BMC
implementations by default.

Thanks to Anand Manian (GE Power Systems) for reporting this 
problem.

@node IPC key conflict, Kernel Driver conflict, Ports conflict, Trouble-shooting
@section Non-unique IPC key
@cindex IPC key conflict
Drivers internally use the inode number of
@file{/var/lib/freeipmi/ipckey} to obtain a system wide unique IPC key
for locking and synchronization through @code{ftok} call.  It is
extremely rare (but possible) for more than one application to
conflict with this IPC key, because @code{ftok} doesn't absolutely 
guarantee system wide uniqueness. 

To regenerate a new system wide unique IPC key, you have to recreate
@file{/var/lib/freeipmi/ipckey} with a new inode number.

Example: Recreating @file{/var/lib/freeipmi/ipckey} file.
@example
debian-ia64:~# touch -f /var/lib/freeipmi/ipckey.new
debian-ia64:~# ls --inode /var/lib/freeipmi/ipckey
2289282 /var/lib/freeipmi/ipckey
debian-ia64:~# ls --inode /var/lib/freeipmi/ipckey.new
2289284 /var/lib/freeipmi/ipckey.new
debian-ia64:~# mv -f /var/lib/freeipmi/ipckey.new
/var/lib/freeipmi/ipckey
debian-ia64:~# ls --inode /var/lib/freeipmi/ipckey
2289284 /var/lib/freeipmi/ipckey
debian-ia64:~#
@end example

@node Kernel Driver conflict,  , IPC key conflict, Trouble-shooting
@section Kernel Driver conflict
@cindex Kernel Driver conflict
All the device drivers are completely written in user-space.  If you
already have any in-kernel @acronym{IPMI} drivers loaded, unload them
before you launch any GNU FreeIPMI utility.

@node Contact us, Authors, Trouble-shooting, Top
@chapter Contact us

@itemize @bullet
@item Homepage:      @uref{http://www.gnu.org/software/freeipmi}

@item Project Main:  @uref{https://savannah.gnu.org/projects/freeipmi/}

@item Download:      @uref{https://savannah.gnu.org/files/?group=freeipmi}

@item Mailing List:  @uref{https://savannah.gnu.org/mail/?group=freeipmi}

@item Support:       @uref{https://savannah.gnu.org/support/?group=freeipmi}

@item Patches:       @uref{https://savannah.gnu.org/patch/?group=freeipmi}

@item News:          @uref{https://savannah.gnu.org/news/?group=freeipmi}

@item Bugs:          @uref{https://savannah.gnu.org/bugs/?group=freeipmi}

@item Tasks:         @uref{https://savannah.gnu.org/task/?group=freeipmi}

@item CVS:           @uref{https://savannah.gnu.org/cvs/?group=freeipmi}
@end itemize

Contact FreeIPMI Core Team <ab(@@)gnu.org.in>

@node Authors, Copying, Contact us, Top
@chapter Authors
@include authors.texi

@node Copying, Glossary, Authors, Top
@chapter Copying
@cindex Copying

@menu
* GNU FreeIPMI license::        
* GNU FreeIPMI documentation license::  
@end menu

@node GNU FreeIPMI license, GNU FreeIPMI documentation license, Copying, Copying
@section GNU FreeIPMI license
@include gpl.texi

@node GNU FreeIPMI documentation license,  , GNU FreeIPMI license, Copying
@section GNU FreeIPMI documentation license
@include fdl.texi

@node Glossary, Concept Index, Copying, Top
@chapter Glossary
@multitable @columnfractions 0.15 0.85
@item BMC   @tab [B]aseboard [M]anagement [C]ontroller.
@item GNU   @tab [G]NU's [N]ot [U]nix.
@item GPL   @tab GNU [G]eneral [P]ublic [L]icense.
@item IP    @tab [I]nternet [P]rotocol.
@item IPMI  @tab [I]ntelligent [P]latform [M]anagement [I]nterface
@item NIS   @tab [N]etwork [I]nformation [S]ervice. 
Also humerously known as [N]etwork [I]ntrusion [S]ervice :) .  
@item RMCP  @tab [R]emote [M]anagement [C]ontrol [P]rotocol.
@item RSH   @tab [R]emote [SH]ell.
@end multitable

@node Concept Index, Program Index, Glossary, Top
@unnumbered Concept index
@printindex cp

@node Program Index,  , Concept Index, Top
@unnumbered Program index
@printindex pg

@bye
